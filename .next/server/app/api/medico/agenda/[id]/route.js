/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/medico/agenda/[id]/route";
exports.ids = ["app/api/medico/agenda/[id]/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$":
/*!****************************************************!*\
  !*** ./node_modules/mysql2/lib/ sync ^cardinal.*$ ***!
  \****************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "process":
/*!**************************!*\
  !*** external "process" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("string_decoder");

/***/ }),

/***/ "timers":
/*!*************************!*\
  !*** external "timers" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("timers");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute&page=%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute&page=%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_ReactProjects_medisuite_pro_frontend_src_app_api_medico_agenda_id_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/medico/agenda/[id]/route.ts */ \"(rsc)/./src/app/api/medico/agenda/[id]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/medico/agenda/[id]/route\",\n        pathname: \"/api/medico/agenda/[id]\",\n        filename: \"route\",\n        bundlePath: \"app/api/medico/agenda/[id]/route\"\n    },\n    resolvedPagePath: \"C:\\\\ReactProjects\\\\medisuite-pro\\\\frontend\\\\src\\\\app\\\\api\\\\medico\\\\agenda\\\\[id]\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_ReactProjects_medisuite_pro_frontend_src_app_api_medico_agenda_id_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/medico/agenda/[id]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtZWRpY28lMkZhZ2VuZGElMkYlNUJpZCU1RCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGbWVkaWNvJTJGYWdlbmRhJTJGJTVCaWQlNUQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZtZWRpY28lMkZhZ2VuZGElMkYlNUJpZCU1RCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDUmVhY3RQcm9qZWN0cyU1Q21lZGlzdWl0ZS1wcm8lNUNmcm9udGVuZCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1JlYWN0UHJvamVjdHMlNUNtZWRpc3VpdGUtcHJvJTVDZnJvbnRlbmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUM7QUFDdEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZWRpc3VpdGUtcHJvLz8xMWIwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFJlYWN0UHJvamVjdHNcXFxcbWVkaXN1aXRlLXByb1xcXFxmcm9udGVuZFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxtZWRpY29cXFxcYWdlbmRhXFxcXFtpZF1cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL21lZGljby9hZ2VuZGEvW2lkXS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL21lZGljby9hZ2VuZGEvW2lkXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbWVkaWNvL2FnZW5kYS9baWRdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcUmVhY3RQcm9qZWN0c1xcXFxtZWRpc3VpdGUtcHJvXFxcXGZyb250ZW5kXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXG1lZGljb1xcXFxhZ2VuZGFcXFxcW2lkXVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9tZWRpY28vYWdlbmRhL1tpZF0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute&page=%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/medico/agenda/[id]/route.ts":
/*!*************************************************!*\
  !*** ./src/app/api/medico/agenda/[id]/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n//frontend\\src\\app\\api\\medico\\agenda\\[id]\\route.ts\n// frontend/src/app/api/medico/agenda/[id]/route.ts\n\n\n// =============== helpers compartidos ===============\nconst SESSION_COOKIE_CANDIDATES = [\n    \"session\",\n    \"session_token\",\n    \"medisalud_session\",\n    \"auth_session\",\n    \"next-auth.session-token\",\n    \"__Secure-next-auth.session-token\"\n];\nfunction getSessionToken(request) {\n    const cookieHeader = request.headers.get(\"cookie\") || \"\";\n    if (cookieHeader) {\n        const cookies = cookieHeader.split(\";\").map((c)=>c.trim()).filter(Boolean).reduce((acc, c)=>{\n            const [k, ...rest] = c.split(\"=\");\n            acc[k] = rest.join(\"=\");\n            return acc;\n        }, {});\n        for (const name of SESSION_COOKIE_CANDIDATES){\n            if (cookies[name]) {\n                return decodeURIComponent(cookies[name]);\n            }\n        }\n    }\n    const auth = request.headers.get(\"authorization\");\n    if (auth?.startsWith(\"Bearer \")) {\n        return auth.slice(7);\n    }\n    return null;\n}\nasync function obtenerMedicoAutenticado(idUsuario) {\n    const [rows] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT \r\n        m.id_medico,\r\n        m.id_usuario,\r\n        m.id_centro_principal\r\n      FROM medicos m\r\n      WHERE m.id_usuario = ? AND m.estado = 'activo'\r\n      LIMIT 1\r\n    `, [\n        idUsuario\n    ]);\n    if (rows.length === 0) return null;\n    return rows[0];\n}\nasync function validarDisponibilidad(idMedico, fechaInicioISO, fechaFinISO, idCitaExcluir) {\n    let query = `\r\n    SELECT COUNT(*) AS conflictos\r\n    FROM citas\r\n    WHERE id_medico = ?\r\n      AND estado NOT IN ('cancelada', 'no_asistio')\r\n      AND (\r\n        (fecha_hora_inicio <= ? AND fecha_hora_fin > ?)\r\n        OR (fecha_hora_inicio < ? AND fecha_hora_fin >= ?)\r\n        OR (fecha_hora_inicio >= ? AND fecha_hora_fin <= ?)\r\n      )\r\n  `;\n    const params = [\n        idMedico,\n        fechaInicioISO,\n        fechaInicioISO,\n        fechaFinISO,\n        fechaFinISO,\n        fechaInicioISO,\n        fechaFinISO\n    ];\n    if (idCitaExcluir) {\n        query += \" AND id_cita != ?\";\n        params.push(idCitaExcluir);\n    }\n    const [rows] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(query, params);\n    return rows[0].conflictos === 0;\n}\n// =============== GET /api/medico/agenda/[id] ===============\nasync function GET(request, { params }) {\n    try {\n        const sessionToken = getSessionToken(request);\n        if (!sessionToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No hay sesi\\xf3n activa\"\n            }, {\n                status: 401\n            });\n        }\n        // validar sesión\n        const [sesiones] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT su.id_usuario\r\n      FROM sesiones_usuarios su\r\n      INNER JOIN usuarios u ON su.id_usuario = u.id_usuario\r\n      WHERE su.token = ?\r\n        AND su.activa = 1\r\n        AND su.fecha_expiracion > NOW()\r\n        AND u.estado = 'activo'\r\n      LIMIT 1\r\n      `, [\n            sessionToken\n        ]);\n        if (sesiones.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Sesi\\xf3n inv\\xe1lida o expirada\"\n            }, {\n                status: 401\n            });\n        }\n        const idUsuario = sesiones[0].id_usuario;\n        // actualizar última actividad\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`UPDATE sesiones_usuarios SET ultima_actividad = NOW() WHERE token = ?`, [\n            sessionToken\n        ]);\n        const medico = await obtenerMedicoAutenticado(idUsuario);\n        if (!medico) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No tienes un registro de m\\xe9dico activo\"\n            }, {\n                status: 403\n            });\n        }\n        const idCita = Number(params.id);\n        if (Number.isNaN(idCita)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ID de cita inv\\xe1lido\"\n            }, {\n                status: 400\n            });\n        }\n        const [citas] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT c.*, \r\n             p.id_paciente,\r\n             CONCAT(p.nombre, ' ', p.apellido_paterno, ' ', COALESCE(p.apellido_materno,'')) AS paciente_nombre,\r\n             TIMESTAMPDIFF(YEAR, p.fecha_nacimiento, CURDATE()) AS paciente_edad,\r\n             p.genero AS paciente_genero,\r\n             p.telefono AS paciente_telefono,\r\n             p.email AS paciente_email\r\n      FROM citas c\r\n      INNER JOIN pacientes p ON c.id_paciente = p.id_paciente\r\n      WHERE c.id_cita = ? AND c.id_medico = ?\r\n      LIMIT 1\r\n      `, [\n            idCita,\n            medico.id_medico\n        ]);\n        if (citas.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Cita no encontrada\"\n            }, {\n                status: 404\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            cita: citas[0]\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"❌ Error en GET /api/medico/agenda/[id]:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: \"Error interno del servidor\",\n            details:  true ? error.message : 0\n        }, {\n            status: 500\n        });\n    }\n}\n// =============== PUT /api/medico/agenda/[id] ===============\nasync function PUT(request, { params }) {\n    // helper local\n    const toMySQLDateTime = (d)=>{\n        const pad = (n)=>n < 10 ? `0${n}` : n;\n        return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;\n    };\n    try {\n        const sessionToken = getSessionToken(request);\n        if (!sessionToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No hay sesi\\xf3n activa\"\n            }, {\n                status: 401\n            });\n        }\n        // validar sesión\n        const [sesiones] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT su.id_usuario\r\n      FROM sesiones_usuarios su\r\n      INNER JOIN usuarios u ON su.id_usuario = u.id_usuario\r\n      WHERE su.token = ?\r\n        AND su.activa = 1\r\n        AND su.fecha_expiracion > NOW()\r\n        AND u.estado = 'activo'\r\n      LIMIT 1\r\n      `, [\n            sessionToken\n        ]);\n        if (sesiones.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Sesi\\xf3n inv\\xe1lida o expirada\"\n            }, {\n                status: 401\n            });\n        }\n        const idUsuario = sesiones[0].id_usuario;\n        // actualizar última actividad\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`UPDATE sesiones_usuarios SET ultima_actividad = NOW() WHERE token = ?`, [\n            sessionToken\n        ]);\n        // obtener médico\n        const medico = await obtenerMedicoAutenticado(idUsuario);\n        if (!medico) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No tienes un registro de m\\xe9dico activo\"\n            }, {\n                status: 403\n            });\n        }\n        const idCita = Number(params.id);\n        if (Number.isNaN(idCita)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ID de cita inv\\xe1lido\"\n            }, {\n                status: 400\n            });\n        }\n        // verificar que la cita pertenece a este médico\n        const [citaActualRows] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`SELECT * FROM citas WHERE id_cita = ? AND id_medico = ? LIMIT 1`, [\n            idCita,\n            medico.id_medico\n        ]);\n        if (citaActualRows.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Cita no encontrada\"\n            }, {\n                status: 404\n            });\n        }\n        const citaActual = citaActualRows[0];\n        // leer body\n        const body = await request.json().catch(()=>({}));\n        const { fecha_hora_inicio, duracion_minutos, tipo_cita, motivo, notas, notas_privadas, estado, prioridad, id_especialidad, id_sala, monto, origen } = body || {};\n        const updates = [];\n        const paramsUpdate = [];\n        // si cambia fecha o duración recalculamos fin y validamos disponibilidad\n        if (fecha_hora_inicio || duracion_minutos) {\n            // fecha base\n            const inicioDate = fecha_hora_inicio ? new Date(fecha_hora_inicio) : new Date(citaActual.fecha_hora_inicio);\n            // ojo: si la fecha viene rara y da Invalid Date\n            if (isNaN(inicioDate.getTime())) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    success: false,\n                    error: \"Formato de fecha inv\\xe1lido. Usa 'YYYY-MM-DD HH:MM:SS'\"\n                }, {\n                    status: 400\n                });\n            }\n            const duracion = duracion_minutos !== undefined ? Number(duracion_minutos) : Number(citaActual.duracion_minutos ?? 30);\n            const finDate = new Date(inicioDate.getTime() + duracion * 60000);\n            const inicioMySQL = toMySQLDateTime(inicioDate);\n            const finMySQL = toMySQLDateTime(finDate);\n            // validar disponibilidad\n            const disponible = await validarDisponibilidad(medico.id_medico, inicioMySQL, finMySQL, idCita);\n            if (!disponible) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    success: false,\n                    error: \"El horario seleccionado no est\\xe1 disponible\"\n                }, {\n                    status: 409\n                });\n            }\n            updates.push(\"fecha_hora_inicio = ?\");\n            paramsUpdate.push(inicioMySQL);\n            updates.push(\"fecha_hora_fin = ?\");\n            paramsUpdate.push(finMySQL);\n            updates.push(\"duracion_minutos = ?\");\n            paramsUpdate.push(duracion);\n        }\n        if (tipo_cita !== undefined) {\n            updates.push(\"tipo_cita = ?\");\n            paramsUpdate.push(tipo_cita);\n        }\n        if (motivo !== undefined) {\n            updates.push(\"motivo = ?\");\n            paramsUpdate.push(motivo);\n        }\n        if (notas !== undefined) {\n            updates.push(\"notas = ?\");\n            paramsUpdate.push(notas);\n        }\n        if (notas_privadas !== undefined) {\n            updates.push(\"notas_privadas = ?\");\n            paramsUpdate.push(notas_privadas);\n        }\n        if (estado !== undefined) {\n            updates.push(\"estado = ?\");\n            paramsUpdate.push(estado);\n        }\n        if (prioridad !== undefined) {\n            updates.push(\"prioridad = ?\");\n            paramsUpdate.push(prioridad);\n        }\n        if (id_especialidad !== undefined) {\n            updates.push(\"id_especialidad = ?\");\n            paramsUpdate.push(id_especialidad);\n        }\n        if (id_sala !== undefined) {\n            updates.push(\"id_sala = ?\");\n            paramsUpdate.push(id_sala);\n        }\n        if (monto !== undefined) {\n            updates.push(\"monto = ?\");\n            paramsUpdate.push(monto);\n        }\n        if (origen !== undefined) {\n            updates.push(\"origen = ?\");\n            paramsUpdate.push(origen);\n        }\n        // siempre registrar quién modificó\n        updates.push(\"modificado_por = ?\");\n        paramsUpdate.push(idUsuario);\n        if (updates.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No hay campos para actualizar\"\n            }, {\n                status: 400\n            });\n        }\n        paramsUpdate.push(idCita);\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`UPDATE citas SET ${updates.join(\", \")} WHERE id_cita = ?`, paramsUpdate);\n        const [citaActualizada] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`SELECT * FROM citas WHERE id_cita = ?`, [\n            idCita\n        ]);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            message: \"Cita actualizada exitosamente\",\n            cita: citaActualizada[0]\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"❌ Error en PUT /api/medico/agenda/[id]:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: \"Error interno del servidor\",\n            // esto te ayuda mientras desarrollas\n            details: error?.message\n        }, {\n            status: 500\n        });\n    }\n}\n// =============== DELETE /api/medico/agenda/[id] ===============\nasync function DELETE(request, { params }) {\n    try {\n        const sessionToken = getSessionToken(request);\n        if (!sessionToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No hay sesi\\xf3n activa\"\n            }, {\n                status: 401\n            });\n        }\n        const [sesiones] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT su.id_usuario\r\n      FROM sesiones_usuarios su\r\n      INNER JOIN usuarios u ON su.id_usuario = u.id_usuario\r\n      WHERE su.token = ?\r\n        AND su.activa = 1\r\n        AND su.fecha_expiracion > NOW()\r\n        AND u.estado = 'activo'\r\n      LIMIT 1\r\n      `, [\n            sessionToken\n        ]);\n        if (sesiones.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Sesi\\xf3n inv\\xe1lida o expirada\"\n            }, {\n                status: 401\n            });\n        }\n        const idUsuario = sesiones[0].id_usuario;\n        // actualizar última actividad\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`UPDATE sesiones_usuarios SET ultima_actividad = NOW() WHERE token = ?`, [\n            sessionToken\n        ]);\n        const medico = await obtenerMedicoAutenticado(idUsuario);\n        if (!medico) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No tienes un registro de m\\xe9dico activo\"\n            }, {\n                status: 403\n            });\n        }\n        const idCita = Number(params.id);\n        if (Number.isNaN(idCita)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ID de cita inv\\xe1lido\"\n            }, {\n                status: 400\n            });\n        }\n        // comprobar que la cita es del médico\n        const [cita] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`SELECT * FROM citas WHERE id_cita = ? AND id_medico = ?`, [\n            idCita,\n            medico.id_medico\n        ]);\n        if (cita.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Cita no encontrada\"\n            }, {\n                status: 404\n            });\n        }\n        // intentar leer motivo del body (si lo mandas)\n        let motivo = \"medico_no_disponible\";\n        let detalle = \"Cancelada por el m\\xe9dico desde la agenda\";\n        try {\n            const body = await request.json();\n            if (body?.motivo) detalle = body.motivo;\n            if (body?.motivo_codigo) motivo = body.motivo_codigo;\n        } catch (_) {\n        // si no hay body no pasa nada\n        }\n        // marcar como cancelada\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`UPDATE citas SET estado = 'cancelada', modificado_por = ? WHERE id_cita = ?`, [\n            idUsuario,\n            idCita\n        ]);\n        // registrar en cancelaciones\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      INSERT INTO cancelaciones (\r\n        id_cita,\r\n        fecha_cancelacion,\r\n        motivo,\r\n        detalle_motivo,\r\n        cancelado_por,\r\n        cancelado_por_tipo\r\n      ) VALUES (?, NOW(), ?, ?, ?, 'medico')\r\n      `, [\n            idCita,\n            motivo,\n            detalle,\n            idUsuario\n        ]);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            message: \"Cita cancelada exitosamente\"\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"❌ Error en DELETE /api/medico/agenda/[id]:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: \"Error interno del servidor\",\n            details:  true ? error.message : 0\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9tZWRpY28vYWdlbmRhL1tpZF0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxrREFBa0Q7QUFDbEQsbURBQW1EO0FBQ0s7QUFDNUI7QUFHNUIsc0RBQXNEO0FBRXRELE1BQU1FLDRCQUE0QjtJQUNoQztJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7Q0FDRDtBQUVELFNBQVNDLGdCQUFnQkMsT0FBb0I7SUFDM0MsTUFBTUMsZUFBZUQsUUFBUUUsT0FBTyxDQUFDQyxHQUFHLENBQUMsYUFBYTtJQUV0RCxJQUFJRixjQUFjO1FBQ2hCLE1BQU1HLFVBQVVILGFBQ2JJLEtBQUssQ0FBQyxLQUNOQyxHQUFHLENBQUMsQ0FBQ0MsSUFBTUEsRUFBRUMsSUFBSSxJQUNqQkMsTUFBTSxDQUFDQyxTQUNQQyxNQUFNLENBQUMsQ0FBQ0MsS0FBS0w7WUFDWixNQUFNLENBQUNNLEdBQUcsR0FBR0MsS0FBSyxHQUFHUCxFQUFFRixLQUFLLENBQUM7WUFDN0JPLEdBQUcsQ0FBQ0MsRUFBRSxHQUFHQyxLQUFLQyxJQUFJLENBQUM7WUFDbkIsT0FBT0g7UUFDVCxHQUFHLENBQUM7UUFFTixLQUFLLE1BQU1JLFFBQVFsQiwwQkFBMkI7WUFDNUMsSUFBSU0sT0FBTyxDQUFDWSxLQUFLLEVBQUU7Z0JBQ2pCLE9BQU9DLG1CQUFtQmIsT0FBTyxDQUFDWSxLQUFLO1lBQ3pDO1FBQ0Y7SUFDRjtJQUVBLE1BQU1FLE9BQU9sQixRQUFRRSxPQUFPLENBQUNDLEdBQUcsQ0FBQztJQUNqQyxJQUFJZSxNQUFNQyxXQUFXLFlBQVk7UUFDL0IsT0FBT0QsS0FBS0UsS0FBSyxDQUFDO0lBQ3BCO0lBRUEsT0FBTztBQUNUO0FBRUEsZUFBZUMseUJBQXlCQyxTQUFpQjtJQUN2RCxNQUFNLENBQUNDLEtBQUssR0FBRyxNQUFNMUIscURBQVUsQ0FDN0IsQ0FBQzs7Ozs7Ozs7SUFRRCxDQUFDLEVBQ0Q7UUFBQ3lCO0tBQVU7SUFHYixJQUFJQyxLQUFLRSxNQUFN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QkFBd0I7UUFDeEIsTUFBTW5HLHFEQUFVLENBQ2QsQ0FBQywyRUFBMkUsQ0FBQyxFQUM3RTtZQUFDeUI7WUFBV3FCO1NBQU87UUFHckIsNkJBQTZCO1FBQzdCLE1BQU05QyxxREFBVSxDQUNkLENBQUM7Ozs7Ozs7OztNQVNELENBQUMsRUFDRDtZQUFDOEM7WUFBUThCO1lBQVFxQjtZQUFTeEU7U0FBVTtRQUd0QyxPQUFPMUIsa0ZBQVlBLENBQUN3QyxJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBTWdCLFNBQVM7UUFBOEIsR0FDeEQ7WUFBRWQsUUFBUTtRQUFJO0lBRWxCLEVBQUUsT0FBT0QsT0FBWTtRQUNuQlksUUFBUVosS0FBSyxDQUFDLDhDQUE4Q0E7UUFDNUQsT0FBTzFDLGtGQUFZQSxDQUFDd0MsSUFBSSxDQUN0QjtZQUNFQyxTQUFTO1lBQ1RDLE9BQU87WUFDUGEsU0FDRUMsS0FBc0MsR0FBR2QsTUFBTWUsT0FBTyxHQUFHQyxDQUFTQTtRQUN0RSxHQUNBO1lBQUVmLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVkaXN1aXRlLXByby8uL3NyYy9hcHAvYXBpL21lZGljby9hZ2VuZGEvW2lkXS9yb3V0ZS50cz83NGU2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vZnJvbnRlbmRcXHNyY1xcYXBwXFxhcGlcXG1lZGljb1xcYWdlbmRhXFxbaWRdXFxyb3V0ZS50c1xyXG4vLyBmcm9udGVuZC9zcmMvYXBwL2FwaS9tZWRpY28vYWdlbmRhL1tpZF0vcm91dGUudHNcclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xyXG5pbXBvcnQgcG9vbCBmcm9tIFwiQC9saWIvZGJcIjtcclxuaW1wb3J0IHsgUm93RGF0YVBhY2tldCwgUmVzdWx0U2V0SGVhZGVyIH0gZnJvbSBcIm15c3FsMlwiO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09IGhlbHBlcnMgY29tcGFydGlkb3MgPT09PT09PT09PT09PT09XHJcblxyXG5jb25zdCBTRVNTSU9OX0NPT0tJRV9DQU5ESURBVEVTID0gW1xyXG4gIFwic2Vzc2lvblwiLFxyXG4gIFwic2Vzc2lvbl90b2tlblwiLFxyXG4gIFwibWVkaXNhbHVkX3Nlc3Npb25cIixcclxuICBcImF1dGhfc2Vzc2lvblwiLFxyXG4gIFwibmV4dC1hdXRoLnNlc3Npb24tdG9rZW5cIixcclxuICBcIl9fU2VjdXJlLW5leHQtYXV0aC5zZXNzaW9uLXRva2VuXCIsXHJcbl07XHJcblxyXG5mdW5jdGlvbiBnZXRTZXNzaW9uVG9rZW4ocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBzdHJpbmcgfCBudWxsIHtcclxuICBjb25zdCBjb29raWVIZWFkZXIgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KFwiY29va2llXCIpIHx8IFwiXCI7XHJcblxyXG4gIGlmIChjb29raWVIZWFkZXIpIHtcclxuICAgIGNvbnN0IGNvb2tpZXMgPSBjb29raWVIZWFkZXJcclxuICAgICAgLnNwbGl0KFwiO1wiKVxyXG4gICAgICAubWFwKChjKSA9PiBjLnRyaW0oKSlcclxuICAgICAgLmZpbHRlcihCb29sZWFuKVxyXG4gICAgICAucmVkdWNlKChhY2MsIGMpID0+IHtcclxuICAgICAgICBjb25zdCBbaywgLi4ucmVzdF0gPSBjLnNwbGl0KFwiPVwiKTtcclxuICAgICAgICBhY2Nba10gPSByZXN0LmpvaW4oXCI9XCIpO1xyXG4gICAgICAgIHJldHVybiBhY2M7XHJcbiAgICAgIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz4pO1xyXG5cclxuICAgIGZvciAoY29uc3QgbmFtZSBvZiBTRVNTSU9OX0NPT0tJRV9DQU5ESURBVEVTKSB7XHJcbiAgICAgIGlmIChjb29raWVzW25hbWVdKSB7XHJcbiAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChjb29raWVzW25hbWVdKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29uc3QgYXV0aCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJhdXRob3JpemF0aW9uXCIpO1xyXG4gIGlmIChhdXRoPy5zdGFydHNXaXRoKFwiQmVhcmVyIFwiKSkge1xyXG4gICAgcmV0dXJuIGF1dGguc2xpY2UoNyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gb2J0ZW5lck1lZGljb0F1dGVudGljYWRvKGlkVXN1YXJpbzogbnVtYmVyKSB7XHJcbiAgY29uc3QgW3Jvd3NdID0gYXdhaXQgcG9vbC5xdWVyeTxSb3dEYXRhUGFja2V0W10+KFxyXG4gICAgYFxyXG4gICAgICBTRUxFQ1QgXHJcbiAgICAgICAgbS5pZF9tZWRpY28sXHJcbiAgICAgICAgbS5pZF91c3VhcmlvLFxyXG4gICAgICAgIG0uaWRfY2VudHJvX3ByaW5jaXBhbFxyXG4gICAgICBGUk9NIG1lZGljb3MgbVxyXG4gICAgICBXSEVSRSBtLmlkX3VzdWFyaW8gPSA/IEFORCBtLmVzdGFkbyA9ICdhY3Rpdm8nXHJcbiAgICAgIExJTUlUIDFcclxuICAgIGAsXHJcbiAgICBbaWRVc3VhcmlvXVxyXG4gICk7XHJcblxyXG4gIGlmIChyb3dzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XHJcbiAgcmV0dXJuIHJvd3NbMF0gYXMge1xyXG4gICAgaWRfbWVkaWNvOiBudW1iZXI7XHJcbiAgICBpZF91c3VhcmlvOiBudW1iZXI7XHJcbiAgICBpZF9jZW50cm9fcHJpbmNpcGFsOiBudW1iZXI7XHJcbiAgfTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gdmFsaWRhckRpc3BvbmliaWxpZGFkKFxyXG4gIGlkTWVkaWNvOiBudW1iZXIsXHJcbiAgZmVjaGFJbmljaW9JU086IHN0cmluZyxcclxuICBmZWNoYUZpbklTTzogc3RyaW5nLFxyXG4gIGlkQ2l0YUV4Y2x1aXI/OiBudW1iZXJcclxuKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgbGV0IHF1ZXJ5ID0gYFxyXG4gICAgU0VMRUNUIENPVU5UKCopIEFTIGNvbmZsaWN0b3NcclxuICAgIEZST00gY2l0YXNcclxuICAgIFdIRVJFIGlkX21lZGljbyA9ID9cclxuICAgICAgQU5EIGVzdGFkbyBOT1QgSU4gKCdjYW5jZWxhZGEnLCAnbm9fYXNpc3RpbycpXHJcbiAgICAgIEFORCAoXHJcbiAgICAgICAgKGZlY2hhX2hvcmFfaW5pY2lvIDw9ID8gQU5EIGZlY2hhX2hvcmFfZmluID4gPylcclxuICAgICAgICBPUiAoZmVjaGFfaG9yYV9pbmljaW8gPCA/IEFORCBmZWNoYV9ob3JhX2ZpbiA+PSA/KVxyXG4gICAgICAgIE9SIChmZWNoYV9ob3JhX2luaWNpbyA+PSA/IEFORCBmZWNoYV9ob3JhX2ZpbiA8PSA/KVxyXG4gICAgICApXHJcbiAgYDtcclxuICBjb25zdCBwYXJhbXM6IGFueVtdID0gW1xyXG4gICAgaWRNZWRpY28sXHJcbiAgICBmZWNoYUluaWNpb0lTTyxcclxuICAgIGZlY2hhSW5pY2lvSVNPLFxyXG4gICAgZmVjaGFGaW5JU08sXHJcbiAgICBmZWNoYUZpbklTTyxcclxuICAgIGZlY2hhSW5pY2lvSVNPLFxyXG4gICAgZmVjaGFGaW5JU08sXHJcbiAgXTtcclxuXHJcbiAgaWYgKGlkQ2l0YUV4Y2x1aXIpIHtcclxuICAgIHF1ZXJ5ICs9IFwiIEFORCBpZF9jaXRhICE9ID9cIjtcclxuICAgIHBhcmFtcy5wdXNoKGlkQ2l0YUV4Y2x1aXIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgW3Jvd3NdID0gYXdhaXQgcG9vbC5xdWVyeTxSb3dEYXRhUGFja2V0W10+KHF1ZXJ5LCBwYXJhbXMpO1xyXG4gIHJldHVybiByb3dzWzBdLmNvbmZsaWN0b3MgPT09IDA7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PSBHRVQgL2FwaS9tZWRpY28vYWdlbmRhL1tpZF0gPT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXHJcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXHJcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cclxuKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHNlc3Npb25Ub2tlbiA9IGdldFNlc3Npb25Ub2tlbihyZXF1ZXN0KTtcclxuICAgIGlmICghc2Vzc2lvblRva2VuKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJObyBoYXkgc2VzacOzbiBhY3RpdmFcIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZhbGlkYXIgc2VzacOzblxyXG4gICAgY29uc3QgW3Nlc2lvbmVzXSA9IGF3YWl0IHBvb2wucXVlcnk8Um93RGF0YVBhY2tldFtdPihcclxuICAgICAgYFxyXG4gICAgICBTRUxFQ1Qgc3UuaWRfdXN1YXJpb1xyXG4gICAgICBGUk9NIHNlc2lvbmVzX3VzdWFyaW9zIHN1XHJcbiAgICAgIElOTkVSIEpPSU4gdXN1YXJpb3MgdSBPTiBzdS5pZF91c3VhcmlvID0gdS5pZF91c3VhcmlvXHJcbiAgICAgIFdIRVJFIHN1LnRva2VuID0gP1xyXG4gICAgICAgIEFORCBzdS5hY3RpdmEgPSAxXHJcbiAgICAgICAgQU5EIHN1LmZlY2hhX2V4cGlyYWNpb24gPiBOT1coKVxyXG4gICAgICAgIEFORCB1LmVzdGFkbyA9ICdhY3Rpdm8nXHJcbiAgICAgIExJTUlUIDFcclxuICAgICAgYCxcclxuICAgICAgW3Nlc3Npb25Ub2tlbl1cclxuICAgICk7XHJcblxyXG4gICAgaWYgKHNlc2lvbmVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiU2VzacOzbiBpbnbDoWxpZGEgbyBleHBpcmFkYVwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaWRVc3VhcmlvID0gc2VzaW9uZXNbMF0uaWRfdXN1YXJpbztcclxuXHJcbiAgICAvLyBhY3R1YWxpemFyIMO6bHRpbWEgYWN0aXZpZGFkXHJcbiAgICBhd2FpdCBwb29sLnF1ZXJ5KFxyXG4gICAgICBgVVBEQVRFIHNlc2lvbmVzX3VzdWFyaW9zIFNFVCB1bHRpbWFfYWN0aXZpZGFkID0gTk9XKCkgV0hFUkUgdG9rZW4gPSA/YCxcclxuICAgICAgW3Nlc3Npb25Ub2tlbl1cclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgbWVkaWNvID0gYXdhaXQgb2J0ZW5lck1lZGljb0F1dGVudGljYWRvKGlkVXN1YXJpbyk7XHJcbiAgICBpZiAoIW1lZGljbykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTm8gdGllbmVzIHVuIHJlZ2lzdHJvIGRlIG3DqWRpY28gYWN0aXZvXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAzIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpZENpdGEgPSBOdW1iZXIocGFyYW1zLmlkKTtcclxuICAgIGlmIChOdW1iZXIuaXNOYU4oaWRDaXRhKSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSUQgZGUgY2l0YSBpbnbDoWxpZG9cIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IFtjaXRhc10gPSBhd2FpdCBwb29sLnF1ZXJ5PFJvd0RhdGFQYWNrZXRbXT4oXHJcbiAgICAgIGBcclxuICAgICAgU0VMRUNUIGMuKiwgXHJcbiAgICAgICAgICAgICBwLmlkX3BhY2llbnRlLFxyXG4gICAgICAgICAgICAgQ09OQ0FUKHAubm9tYnJlLCAnICcsIHAuYXBlbGxpZG9fcGF0ZXJubywgJyAnLCBDT0FMRVNDRShwLmFwZWxsaWRvX21hdGVybm8sJycpKSBBUyBwYWNpZW50ZV9ub21icmUsXHJcbiAgICAgICAgICAgICBUSU1FU1RBTVBESUZGKFlFQVIsIHAuZmVjaGFfbmFjaW1pZW50bywgQ1VSREFURSgpKSBBUyBwYWNpZW50ZV9lZGFkLFxyXG4gICAgICAgICAgICAgcC5nZW5lcm8gQVMgcGFjaWVudGVfZ2VuZXJvLFxyXG4gICAgICAgICAgICAgcC50ZWxlZm9ubyBBUyBwYWNpZW50ZV90ZWxlZm9ubyxcclxuICAgICAgICAgICAgIHAuZW1haWwgQVMgcGFjaWVudGVfZW1haWxcclxuICAgICAgRlJPTSBjaXRhcyBjXHJcbiAgICAgIElOTkVSIEpPSU4gcGFjaWVudGVzIHAgT04gYy5pZF9wYWNpZW50ZSA9IHAuaWRfcGFjaWVudGVcclxuICAgICAgV0hFUkUgYy5pZF9jaXRhID0gPyBBTkQgYy5pZF9tZWRpY28gPSA/XHJcbiAgICAgIExJTUlUIDFcclxuICAgICAgYCxcclxuICAgICAgW2lkQ2l0YSwgbWVkaWNvLmlkX21lZGljb11cclxuICAgICk7XHJcblxyXG4gICAgaWYgKGNpdGFzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ2l0YSBubyBlbmNvbnRyYWRhXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDA0IH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGNpdGE6IGNpdGFzWzBdLFxyXG4gICAgICB9LFxyXG4gICAgICB7IHN0YXR1czogMjAwIH1cclxuICAgICk7XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBlbiBHRVQgL2FwaS9tZWRpY28vYWdlbmRhL1tpZF06XCIsIGVycm9yKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBcIkVycm9yIGludGVybm8gZGVsIHNlcnZpZG9yXCIsXHJcbiAgICAgICAgZGV0YWlsczpcclxuICAgICAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgPyBlcnJvci5tZXNzYWdlIDogdW5kZWZpbmVkLFxyXG4gICAgICB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT0gUFVUIC9hcGkvbWVkaWNvL2FnZW5kYS9baWRdID09PT09PT09PT09PT09PVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUFVUKFxyXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxyXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9XHJcbikge1xyXG4gIC8vIGhlbHBlciBsb2NhbFxyXG4gIGNvbnN0IHRvTXlTUUxEYXRlVGltZSA9IChkOiBEYXRlKSA9PiB7XHJcbiAgICBjb25zdCBwYWQgPSAobjogbnVtYmVyKSA9PiAobiA8IDEwID8gYDAke259YCA6IG4pO1xyXG4gICAgcmV0dXJuIGAke2QuZ2V0RnVsbFllYXIoKX0tJHtwYWQoZC5nZXRNb250aCgpICsgMSl9LSR7cGFkKGQuZ2V0RGF0ZSgpKX0gJHtwYWQoZC5nZXRIb3VycygpKX06JHtwYWQoZC5nZXRNaW51dGVzKCkpfToke3BhZChkLmdldFNlY29uZHMoKSl9YDtcclxuICB9O1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3Qgc2Vzc2lvblRva2VuID0gZ2V0U2Vzc2lvblRva2VuKHJlcXVlc3QpO1xyXG4gICAgaWYgKCFzZXNzaW9uVG9rZW4pIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIk5vIGhheSBzZXNpw7NuIGFjdGl2YVwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmFsaWRhciBzZXNpw7NuXHJcbiAgICBjb25zdCBbc2VzaW9uZXNdID0gYXdhaXQgcG9vbC5xdWVyeTxSb3dEYXRhUGFja2V0W10+KFxyXG4gICAgICBgXHJcbiAgICAgIFNFTEVDVCBzdS5pZF91c3VhcmlvXHJcbiAgICAgIEZST00gc2VzaW9uZXNfdXN1YXJpb3Mgc3VcclxuICAgICAgSU5ORVIgSk9JTiB1c3VhcmlvcyB1IE9OIHN1LmlkX3VzdWFyaW8gPSB1LmlkX3VzdWFyaW9cclxuICAgICAgV0hFUkUgc3UudG9rZW4gPSA/XHJcbiAgICAgICAgQU5EIHN1LmFjdGl2YSA9IDFcclxuICAgICAgICBBTkQgc3UuZmVjaGFfZXhwaXJhY2lvbiA+IE5PVygpXHJcbiAgICAgICAgQU5EIHUuZXN0YWRvID0gJ2FjdGl2bydcclxuICAgICAgTElNSVQgMVxyXG4gICAgICBgLFxyXG4gICAgICBbc2Vzc2lvblRva2VuXVxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoc2VzaW9uZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJTZXNpw7NuIGludsOhbGlkYSBvIGV4cGlyYWRhXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAxIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpZFVzdWFyaW8gPSBzZXNpb25lc1swXS5pZF91c3VhcmlvO1xyXG5cclxuICAgIC8vIGFjdHVhbGl6YXIgw7psdGltYSBhY3RpdmlkYWRcclxuICAgIGF3YWl0IHBvb2wucXVlcnkoXHJcbiAgICAgIGBVUERBVEUgc2VzaW9uZXNfdXN1YXJpb3MgU0VUIHVsdGltYV9hY3RpdmlkYWQgPSBOT1coKSBXSEVSRSB0b2tlbiA9ID9gLFxyXG4gICAgICBbc2Vzc2lvblRva2VuXVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBvYnRlbmVyIG3DqWRpY29cclxuICAgIGNvbnN0IG1lZGljbyA9IGF3YWl0IG9idGVuZXJNZWRpY29BdXRlbnRpY2FkbyhpZFVzdWFyaW8pO1xyXG4gICAgaWYgKCFtZWRpY28pIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIk5vIHRpZW5lcyB1biByZWdpc3RybyBkZSBtw6lkaWNvIGFjdGl2b1wiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMyB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaWRDaXRhID0gTnVtYmVyKHBhcmFtcy5pZCk7XHJcbiAgICBpZiAoTnVtYmVyLmlzTmFOKGlkQ2l0YSkpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIklEIGRlIGNpdGEgaW52w6FsaWRvXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZmljYXIgcXVlIGxhIGNpdGEgcGVydGVuZWNlIGEgZXN0ZSBtw6lkaWNvXHJcbiAgICBjb25zdCBbY2l0YUFjdHVhbFJvd3NdID0gYXdhaXQgcG9vbC5xdWVyeTxSb3dEYXRhUGFja2V0W10+KFxyXG4gICAgICBgU0VMRUNUICogRlJPTSBjaXRhcyBXSEVSRSBpZF9jaXRhID0gPyBBTkQgaWRfbWVkaWNvID0gPyBMSU1JVCAxYCxcclxuICAgICAgW2lkQ2l0YSwgbWVkaWNvLmlkX21lZGljb11cclxuICAgICk7XHJcblxyXG4gICAgaWYgKGNpdGFBY3R1YWxSb3dzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ2l0YSBubyBlbmNvbnRyYWRhXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDA0IH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjaXRhQWN0dWFsID0gY2l0YUFjdHVhbFJvd3NbMF07XHJcblxyXG4gICAgLy8gbGVlciBib2R5XHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XHJcbiAgICBjb25zdCB7XHJcbiAgICAgIGZlY2hhX2hvcmFfaW5pY2lvLFxyXG4gICAgICBkdXJhY2lvbl9taW51dG9zLFxyXG4gICAgICB0aXBvX2NpdGEsXHJcbiAgICAgIG1vdGl2byxcclxuICAgICAgbm90YXMsXHJcbiAgICAgIG5vdGFzX3ByaXZhZGFzLFxyXG4gICAgICBlc3RhZG8sXHJcbiAgICAgIHByaW9yaWRhZCxcclxuICAgICAgaWRfZXNwZWNpYWxpZGFkLFxyXG4gICAgICBpZF9zYWxhLFxyXG4gICAgICBtb250byxcclxuICAgICAgb3JpZ2VuLFxyXG4gICAgfSA9IGJvZHkgfHwge307XHJcblxyXG4gICAgY29uc3QgdXBkYXRlczogc3RyaW5nW10gPSBbXTtcclxuICAgIGNvbnN0IHBhcmFtc1VwZGF0ZTogYW55W10gPSBbXTtcclxuXHJcbiAgICAvLyBzaSBjYW1iaWEgZmVjaGEgbyBkdXJhY2nDs24gcmVjYWxjdWxhbW9zIGZpbiB5IHZhbGlkYW1vcyBkaXNwb25pYmlsaWRhZFxyXG4gICAgaWYgKGZlY2hhX2hvcmFfaW5pY2lvIHx8IGR1cmFjaW9uX21pbnV0b3MpIHtcclxuICAgICAgLy8gZmVjaGEgYmFzZVxyXG4gICAgICBjb25zdCBpbmljaW9EYXRlID0gZmVjaGFfaG9yYV9pbmljaW9cclxuICAgICAgICA/IG5ldyBEYXRlKGZlY2hhX2hvcmFfaW5pY2lvKVxyXG4gICAgICAgIDogbmV3IERhdGUoY2l0YUFjdHVhbC5mZWNoYV9ob3JhX2luaWNpbyk7XHJcblxyXG4gICAgICAvLyBvam86IHNpIGxhIGZlY2hhIHZpZW5lIHJhcmEgeSBkYSBJbnZhbGlkIERhdGVcclxuICAgICAgaWYgKGlzTmFOKGluaWNpb0RhdGUuZ2V0VGltZSgpKSkge1xyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICAgIGVycm9yOiBcIkZvcm1hdG8gZGUgZmVjaGEgaW52w6FsaWRvLiBVc2EgJ1lZWVktTU0tREQgSEg6TU06U1MnXCIsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgZHVyYWNpb24gPVxyXG4gICAgICAgIGR1cmFjaW9uX21pbnV0b3MgIT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgPyBOdW1iZXIoZHVyYWNpb25fbWludXRvcylcclxuICAgICAgICAgIDogTnVtYmVyKGNpdGFBY3R1YWwuZHVyYWNpb25fbWludXRvcyA/PyAzMCk7XHJcblxyXG4gICAgICBjb25zdCBmaW5EYXRlID0gbmV3IERhdGUoaW5pY2lvRGF0ZS5nZXRUaW1lKCkgKyBkdXJhY2lvbiAqIDYwMDAwKTtcclxuXHJcbiAgICAgIGNvbnN0IGluaWNpb015U1FMID0gdG9NeVNRTERhdGVUaW1lKGluaWNpb0RhdGUpO1xyXG4gICAgICBjb25zdCBmaW5NeVNRTCA9IHRvTXlTUUxEYXRlVGltZShmaW5EYXRlKTtcclxuXHJcbiAgICAgIC8vIHZhbGlkYXIgZGlzcG9uaWJpbGlkYWRcclxuICAgICAgY29uc3QgZGlzcG9uaWJsZSA9IGF3YWl0IHZhbGlkYXJEaXNwb25pYmlsaWRhZChcclxuICAgICAgICBtZWRpY28uaWRfbWVkaWNvLFxyXG4gICAgICAgIGluaWNpb015U1FMLFxyXG4gICAgICAgIGZpbk15U1FMLFxyXG4gICAgICAgIGlkQ2l0YVxyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKCFkaXNwb25pYmxlKSB7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgZXJyb3I6IFwiRWwgaG9yYXJpbyBzZWxlY2Npb25hZG8gbm8gZXN0w6EgZGlzcG9uaWJsZVwiLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHsgc3RhdHVzOiA0MDkgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHVwZGF0ZXMucHVzaChcImZlY2hhX2hvcmFfaW5pY2lvID0gP1wiKTtcclxuICAgICAgcGFyYW1zVXBkYXRlLnB1c2goaW5pY2lvTXlTUUwpO1xyXG4gICAgICB1cGRhdGVzLnB1c2goXCJmZWNoYV9ob3JhX2ZpbiA9ID9cIik7XHJcbiAgICAgIHBhcmFtc1VwZGF0ZS5wdXNoKGZpbk15U1FMKTtcclxuICAgICAgdXBkYXRlcy5wdXNoKFwiZHVyYWNpb25fbWludXRvcyA9ID9cIik7XHJcbiAgICAgIHBhcmFtc1VwZGF0ZS5wdXNoKGR1cmFjaW9uKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGlwb19jaXRhICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlcy5wdXNoKFwidGlwb19jaXRhID0gP1wiKTtcclxuICAgICAgcGFyYW1zVXBkYXRlLnB1c2godGlwb19jaXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobW90aXZvICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlcy5wdXNoKFwibW90aXZvID0gP1wiKTtcclxuICAgICAgcGFyYW1zVXBkYXRlLnB1c2gobW90aXZvKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobm90YXMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVzLnB1c2goXCJub3RhcyA9ID9cIik7XHJcbiAgICAgIHBhcmFtc1VwZGF0ZS5wdXNoKG5vdGFzKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobm90YXNfcHJpdmFkYXMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVzLnB1c2goXCJub3Rhc19wcml2YWRhcyA9ID9cIik7XHJcbiAgICAgIHBhcmFtc1VwZGF0ZS5wdXNoKG5vdGFzX3ByaXZhZGFzKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZXN0YWRvICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlcy5wdXNoKFwiZXN0YWRvID0gP1wiKTtcclxuICAgICAgcGFyYW1zVXBkYXRlLnB1c2goZXN0YWRvKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocHJpb3JpZGFkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlcy5wdXNoKFwicHJpb3JpZGFkID0gP1wiKTtcclxuICAgICAgcGFyYW1zVXBkYXRlLnB1c2gocHJpb3JpZGFkKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoaWRfZXNwZWNpYWxpZGFkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlcy5wdXNoKFwiaWRfZXNwZWNpYWxpZGFkID0gP1wiKTtcclxuICAgICAgcGFyYW1zVXBkYXRlLnB1c2goaWRfZXNwZWNpYWxpZGFkKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoaWRfc2FsYSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHVwZGF0ZXMucHVzaChcImlkX3NhbGEgPSA/XCIpO1xyXG4gICAgICBwYXJhbXNVcGRhdGUucHVzaChpZF9zYWxhKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobW9udG8gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB1cGRhdGVzLnB1c2goXCJtb250byA9ID9cIik7XHJcbiAgICAgIHBhcmFtc1VwZGF0ZS5wdXNoKG1vbnRvKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3JpZ2VuICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgdXBkYXRlcy5wdXNoKFwib3JpZ2VuID0gP1wiKTtcclxuICAgICAgcGFyYW1zVXBkYXRlLnB1c2gob3JpZ2VuKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBzaWVtcHJlIHJlZ2lzdHJhciBxdWnDqW4gbW9kaWZpY8OzXHJcbiAgICB1cGRhdGVzLnB1c2goXCJtb2RpZmljYWRvX3BvciA9ID9cIik7XHJcbiAgICBwYXJhbXNVcGRhdGUucHVzaChpZFVzdWFyaW8pO1xyXG5cclxuICAgIGlmICh1cGRhdGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTm8gaGF5IGNhbXBvcyBwYXJhIGFjdHVhbGl6YXJcIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHBhcmFtc1VwZGF0ZS5wdXNoKGlkQ2l0YSk7XHJcblxyXG4gICAgYXdhaXQgcG9vbC5xdWVyeShcclxuICAgICAgYFVQREFURSBjaXRhcyBTRVQgJHt1cGRhdGVzLmpvaW4oXCIsIFwiKX0gV0hFUkUgaWRfY2l0YSA9ID9gLFxyXG4gICAgICBwYXJhbXNVcGRhdGVcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgW2NpdGFBY3R1YWxpemFkYV0gPSBhd2FpdCBwb29sLnF1ZXJ5PFJvd0RhdGFQYWNrZXRbXT4oXHJcbiAgICAgIGBTRUxFQ1QgKiBGUk9NIGNpdGFzIFdIRVJFIGlkX2NpdGEgPSA/YCxcclxuICAgICAgW2lkQ2l0YV1cclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBtZXNzYWdlOiBcIkNpdGEgYWN0dWFsaXphZGEgZXhpdG9zYW1lbnRlXCIsXHJcbiAgICAgICAgY2l0YTogY2l0YUFjdHVhbGl6YWRhWzBdLFxyXG4gICAgICB9LFxyXG4gICAgICB7IHN0YXR1czogMjAwIH1cclxuICAgICk7XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBlbiBQVVQgL2FwaS9tZWRpY28vYWdlbmRhL1tpZF06XCIsIGVycm9yKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBcIkVycm9yIGludGVybm8gZGVsIHNlcnZpZG9yXCIsXHJcbiAgICAgICAgLy8gZXN0byB0ZSBheXVkYSBtaWVudHJhcyBkZXNhcnJvbGxhc1xyXG4gICAgICAgIGRldGFpbHM6IGVycm9yPy5tZXNzYWdlLFxyXG4gICAgICB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuLy8gPT09PT09PT09PT09PT09IERFTEVURSAvYXBpL21lZGljby9hZ2VuZGEvW2lkXSA9PT09PT09PT09PT09PT1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIERFTEVURShcclxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcclxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogeyBpZDogc3RyaW5nIH0gfVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc2Vzc2lvblRva2VuID0gZ2V0U2Vzc2lvblRva2VuKHJlcXVlc3QpO1xyXG4gICAgaWYgKCFzZXNzaW9uVG9rZW4pIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIk5vIGhheSBzZXNpw7NuIGFjdGl2YVwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgW3Nlc2lvbmVzXSA9IGF3YWl0IHBvb2wucXVlcnk8Um93RGF0YVBhY2tldFtdPihcclxuICAgICAgYFxyXG4gICAgICBTRUxFQ1Qgc3UuaWRfdXN1YXJpb1xyXG4gICAgICBGUk9NIHNlc2lvbmVzX3VzdWFyaW9zIHN1XHJcbiAgICAgIElOTkVSIEpPSU4gdXN1YXJpb3MgdSBPTiBzdS5pZF91c3VhcmlvID0gdS5pZF91c3VhcmlvXHJcbiAgICAgIFdIRVJFIHN1LnRva2VuID0gP1xyXG4gICAgICAgIEFORCBzdS5hY3RpdmEgPSAxXHJcbiAgICAgICAgQU5EIHN1LmZlY2hhX2V4cGlyYWNpb24gPiBOT1coKVxyXG4gICAgICAgIEFORCB1LmVzdGFkbyA9ICdhY3Rpdm8nXHJcbiAgICAgIExJTUlUIDFcclxuICAgICAgYCxcclxuICAgICAgW3Nlc3Npb25Ub2tlbl1cclxuICAgICk7XHJcblxyXG4gICAgaWYgKHNlc2lvbmVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiU2VzacOzbiBpbnbDoWxpZGEgbyBleHBpcmFkYVwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaWRVc3VhcmlvID0gc2VzaW9uZXNbMF0uaWRfdXN1YXJpbztcclxuXHJcbiAgICAvLyBhY3R1YWxpemFyIMO6bHRpbWEgYWN0aXZpZGFkXHJcbiAgICBhd2FpdCBwb29sLnF1ZXJ5KFxyXG4gICAgICBgVVBEQVRFIHNlc2lvbmVzX3VzdWFyaW9zIFNFVCB1bHRpbWFfYWN0aXZpZGFkID0gTk9XKCkgV0hFUkUgdG9rZW4gPSA/YCxcclxuICAgICAgW3Nlc3Npb25Ub2tlbl1cclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgbWVkaWNvID0gYXdhaXQgb2J0ZW5lck1lZGljb0F1dGVudGljYWRvKGlkVXN1YXJpbyk7XHJcbiAgICBpZiAoIW1lZGljbykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTm8gdGllbmVzIHVuIHJlZ2lzdHJvIGRlIG3DqWRpY28gYWN0aXZvXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAzIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpZENpdGEgPSBOdW1iZXIocGFyYW1zLmlkKTtcclxuICAgIGlmIChOdW1iZXIuaXNOYU4oaWRDaXRhKSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSUQgZGUgY2l0YSBpbnbDoWxpZG9cIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNvbXByb2JhciBxdWUgbGEgY2l0YSBlcyBkZWwgbcOpZGljb1xyXG4gICAgY29uc3QgW2NpdGFdID0gYXdhaXQgcG9vbC5xdWVyeTxSb3dEYXRhUGFja2V0W10+KFxyXG4gICAgICBgU0VMRUNUICogRlJPTSBjaXRhcyBXSEVSRSBpZF9jaXRhID0gPyBBTkQgaWRfbWVkaWNvID0gP2AsXHJcbiAgICAgIFtpZENpdGEsIG1lZGljby5pZF9tZWRpY29dXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChjaXRhLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ2l0YSBubyBlbmNvbnRyYWRhXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDA0IH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBpbnRlbnRhciBsZWVyIG1vdGl2byBkZWwgYm9keSAoc2kgbG8gbWFuZGFzKVxyXG4gICAgbGV0IG1vdGl2byA9IFwibWVkaWNvX25vX2Rpc3BvbmlibGVcIjtcclxuICAgIGxldCBkZXRhbGxlID0gXCJDYW5jZWxhZGEgcG9yIGVsIG3DqWRpY28gZGVzZGUgbGEgYWdlbmRhXCI7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICAgIGlmIChib2R5Py5tb3Rpdm8pIGRldGFsbGUgPSBib2R5Lm1vdGl2bztcclxuICAgICAgaWYgKGJvZHk/Lm1vdGl2b19jb2RpZ28pIG1vdGl2byA9IGJvZHkubW90aXZvX2NvZGlnbztcclxuICAgIH0gY2F0Y2ggKF8pIHtcclxuICAgICAgLy8gc2kgbm8gaGF5IGJvZHkgbm8gcGFzYSBuYWRhXHJcbiAgICB9XHJcblxyXG4gICAgLy8gbWFyY2FyIGNvbW8gY2FuY2VsYWRhXHJcbiAgICBhd2FpdCBwb29sLnF1ZXJ5KFxyXG4gICAgICBgVVBEQVRFIGNpdGFzIFNFVCBlc3RhZG8gPSAnY2FuY2VsYWRhJywgbW9kaWZpY2Fkb19wb3IgPSA/IFdIRVJFIGlkX2NpdGEgPSA/YCxcclxuICAgICAgW2lkVXN1YXJpbywgaWRDaXRhXVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyByZWdpc3RyYXIgZW4gY2FuY2VsYWNpb25lc1xyXG4gICAgYXdhaXQgcG9vbC5xdWVyeShcclxuICAgICAgYFxyXG4gICAgICBJTlNFUlQgSU5UTyBjYW5jZWxhY2lvbmVzIChcclxuICAgICAgICBpZF9jaXRhLFxyXG4gICAgICAgIGZlY2hhX2NhbmNlbGFjaW9uLFxyXG4gICAgICAgIG1vdGl2byxcclxuICAgICAgICBkZXRhbGxlX21vdGl2byxcclxuICAgICAgICBjYW5jZWxhZG9fcG9yLFxyXG4gICAgICAgIGNhbmNlbGFkb19wb3JfdGlwb1xyXG4gICAgICApIFZBTFVFUyAoPywgTk9XKCksID8sID8sID8sICdtZWRpY28nKVxyXG4gICAgICBgLFxyXG4gICAgICBbaWRDaXRhLCBtb3Rpdm8sIGRldGFsbGUsIGlkVXN1YXJpb11cclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6IFwiQ2l0YSBjYW5jZWxhZGEgZXhpdG9zYW1lbnRlXCIgfSxcclxuICAgICAgeyBzdGF0dXM6IDIwMCB9XHJcbiAgICApO1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRXJyb3IgZW4gREVMRVRFIC9hcGkvbWVkaWNvL2FnZW5kYS9baWRdOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogXCJFcnJvciBpbnRlcm5vIGRlbCBzZXJ2aWRvclwiLFxyXG4gICAgICAgIGRldGFpbHM6XHJcbiAgICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJkZXZlbG9wbWVudFwiID8gZXJyb3IubWVzc2FnZSA6IHVuZGVmaW5lZCxcclxuICAgICAgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicG9vbCIsIlNFU1NJT05fQ09PS0lFX0NBTkRJREFURVMiLCJnZXRTZXNzaW9uVG9rZW4iLCJyZXF1ZXN0IiwiY29va2llSGVhZGVyIiwiaGVhZGVycyIsImdldCIsImNvb2tpZXMiLCJzcGxpdCIsIm1hcCIsImMiLCJ0cmltIiwiZmlsdGVyIiwiQm9vbGVhbiIsInJlZHVjZSIsImFjYyIsImsiLCJyZXN0Iiwiam9pbiIsIm5hbWUiLCJkZWNvZGVVUklDb21wb25lbnQiLCJhdXRoIiwic3RhcnRzV2l0aCIsInNsaWNlIiwib2J0ZW5lck1lZGljb0F1dGVudGljYWRvIiwiaWRVc3VhcmlvIiwicm93cyIsInF1ZXJ5IiwibGVuZ3RoIiwidmFsaWRhckRpc3BvbmliaWxpZGFkIiwiaWRNZWRpY28iLCJmZWNoYUluaWNpb0lTTyIsImZlY2hhRmluSVNPIiwiaWRDaXRhRXhjbHVpciIsInBhcmFtcyIsInB1c2giLCJjb25mbGljdG9zIiwiR0VUIiwic2Vzc2lvblRva2VuIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsInN0YXR1cyIsInNlc2lvbmVzIiwiaWRfdXN1YXJpbyIsIm1lZGljbyIsImlkQ2l0YSIsIk51bWJlciIsImlkIiwiaXNOYU4iLCJjaXRhcyIsImlkX21lZGljbyIsImNpdGEiLCJjb25zb2xlIiwiZGV0YWlscyIsInByb2Nlc3MiLCJtZXNzYWdlIiwidW5kZWZpbmVkIiwiUFVUIiwidG9NeVNRTERhdGVUaW1lIiwiZCIsInBhZCIsIm4iLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsImdldFNlY29uZHMiLCJjaXRhQWN0dWFsUm93cyIsImNpdGFBY3R1YWwiLCJib2R5IiwiY2F0Y2giLCJmZWNoYV9ob3JhX2luaWNpbyIsImR1cmFjaW9uX21pbnV0b3MiLCJ0aXBvX2NpdGEiLCJtb3Rpdm8iLCJub3RhcyIsIm5vdGFzX3ByaXZhZGFzIiwiZXN0YWRvIiwicHJpb3JpZGFkIiwiaWRfZXNwZWNpYWxpZGFkIiwiaWRfc2FsYSIsIm1vbnRvIiwib3JpZ2VuIiwidXBkYXRlcyIsInBhcmFtc1VwZGF0ZSIsImluaWNpb0RhdGUiLCJEYXRlIiwiZ2V0VGltZSIsImR1cmFjaW9uIiwiZmluRGF0ZSIsImluaWNpb015U1FMIiwiZmluTXlTUUwiLCJkaXNwb25pYmxlIiwiY2l0YUFjdHVhbGl6YWRhIiwiREVMRVRFIiwiZGV0YWxsZSIsIm1vdGl2b19jb2RpZ28iLCJfIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/medico/agenda/[id]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getConnection: () => (/* binding */ getConnection),\n/* harmony export */   getGlobalStats: () => (/* binding */ getGlobalStats),\n/* harmony export */   getUserByEmail: () => (/* binding */ getUserByEmail),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   verifyUserCredentials: () => (/* binding */ verifyUserCredentials),\n/* harmony export */   withTransaction: () => (/* binding */ withTransaction)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"(rsc)/./node_modules/mysql2/promise.js\");\n// ===============================================================\n// 📦 Archivo: src/lib/db.ts\n// 🧠 Descripción: Configuración central de conexión a MySQL y utilidades\n// ===============================================================\n\n// ===============================================================\n// 🔗 Conexión al pool MySQL (segura, reutilizable y escalable)\n// ===============================================================\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0__.createPool({\n    host: process.env.DB_HOST || \"localhost\",\n    user: process.env.DB_USER || \"root\",\n    password: process.env.DB_PASS || \"\",\n    database: process.env.DB_NAME || \"Anyssamed\",\n    waitForConnections: true,\n    connectionLimit: 10,\n    queueLimit: 0,\n    multipleStatements: false,\n    namedPlaceholders: true\n});\n// ===============================================================\n// 🧩 Función genérica para ejecutar consultas seguras\n// ===============================================================\nasync function query(sql, params = []) {\n    try {\n        const [rows] = await pool.query(sql, params);\n        return rows;\n    } catch (error) {\n        console.error(\"❌ Error en query MySQL:\", error.message);\n        throw new Error(`Error en consulta: ${error.message}`);\n    }\n}\n// ===============================================================\n// 👤 Obtener usuario por email o username (para login o validaciones)\n// ✅ Versión que PRIORIZA el rol MÉDICO y solo toma roles activos\n// ===============================================================\nasync function getUserByEmail(emailOrUsername) {\n    const sql = `\r\n    SELECT \r\n      u.id_usuario,\r\n      u.email,\r\n      u.username,\r\n      u.nombre,\r\n      u.apellido_paterno,\r\n      u.password_hash,\r\n      -- si no hay rol, devolvemos 'Sin Rol'\r\n      COALESCE(r.nombre, 'Sin Rol') AS rol\r\n    FROM usuarios u\r\n    -- solo roles activos del usuario\r\n    LEFT JOIN usuarios_roles ur \r\n      ON u.id_usuario = ur.id_usuario\r\n      AND ur.activo = 1\r\n    -- solo roles activos en la tabla roles\r\n    LEFT JOIN roles r \r\n      ON ur.id_rol = r.id_rol\r\n      AND r.estado = 'activo'\r\n    WHERE (u.email = ? OR u.username = ?)\r\n      AND u.estado = 'activo'\r\n    -- PRIORIDAD de rol:\r\n    -- 1) médico\r\n    -- 2) superadmin\r\n    -- 3) admin/administrativo\r\n    -- 4) secretaria\r\n    -- 5) técnico\r\n    -- 6) lo que quede\r\n    ORDER BY\r\n      CASE\r\n        WHEN LOWER(r.nombre) LIKE '%medico%' THEN 1\r\n        WHEN LOWER(r.nombre) LIKE '%super%' THEN 2\r\n        WHEN LOWER(r.nombre) LIKE '%admin%' THEN 3\r\n        WHEN LOWER(r.nombre) LIKE '%secret%' THEN 4\r\n        WHEN LOWER(r.nombre) LIKE '%tecnic%' THEN 5\r\n        ELSE 99\r\n      END,\r\n      r.nivel_jerarquia DESC\r\n    LIMIT 1\r\n  `;\n    const [rows] = await pool.query(sql, [\n        emailOrUsername,\n        emailOrUsername\n    ]);\n    return Array.isArray(rows) && rows.length > 0 ? rows[0] : null;\n}\n// ===============================================================\n// 🔒 Verificar credenciales del usuario\n// ===============================================================\nasync function verifyUserCredentials(emailOrUsername, passwordHash) {\n    const user = await getUserByEmail(emailOrUsername);\n    if (!user) return null;\n    if (user.password_hash !== passwordHash) return null;\n    return user;\n}\n// ===============================================================\n// 📊 Ejemplo de utilidad: obtener estadísticas globales\n// ===============================================================\nasync function getGlobalStats() {\n    const [[stats]] = await pool.query(`\r\n    SELECT \r\n      (SELECT COUNT(*) FROM usuarios) AS total_usuarios,\r\n      (SELECT COUNT(*) FROM pacientes) AS total_pacientes,\r\n      (SELECT COUNT(*) FROM medicos) AS total_medicos,\r\n      (SELECT COUNT(*) FROM centros_medicos) AS total_centros\r\n  `);\n    return stats;\n}\n// ===============================================================\n// 🔌 NUEVO: obtener una conexión dedicada (para transacciones)\n// ===============================================================\nasync function getConnection() {\n    const conn = await pool.getConnection();\n    try {\n        await conn.ping(); // valida la conexión\n    } catch (e) {\n        conn.release();\n        throw e;\n    }\n    return conn;\n}\n// ===============================================================\n// 🔁 NUEVO (opcional): helper para ejecutar en transacción\n// ===============================================================\nasync function withTransaction(fn) {\n    const conn = await getConnection();\n    try {\n        await conn.beginTransaction();\n        const result = await fn(conn);\n        await conn.commit();\n        return result;\n    } catch (err) {\n        try {\n            await conn.rollback();\n        } catch  {}\n        throw err;\n    } finally{\n        try {\n            conn.release();\n        } catch  {}\n    }\n}\n// ===============================================================\n// 🔁 Exportar conexión global\n// ===============================================================\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VSxRQUFRO1FBQUksRUFBRSxPQUFNLENBQUM7UUFDdEMsTUFBTUQ7SUFDUixTQUFVO1FBQ1IsSUFBSTtZQUFFVCxLQUFLRyxPQUFPO1FBQUksRUFBRSxPQUFNLENBQUM7SUFDakM7QUFDRjtBQUVBLGtFQUFrRTtBQUNsRSw4QkFBOEI7QUFDOUIsa0VBQWtFO0FBQ2xFLGlFQUFldkMsSUFBSUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL21lZGlzdWl0ZS1wcm8vLi9zcmMvbGliL2RiLnRzPzllNGYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIPCfk6YgQXJjaGl2bzogc3JjL2xpYi9kYi50c1xyXG4vLyDwn6egIERlc2NyaXBjacOzbjogQ29uZmlndXJhY2nDs24gY2VudHJhbCBkZSBjb25leGnDs24gYSBNeVNRTCB5IHV0aWxpZGFkZXNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5pbXBvcnQgbXlzcWwgZnJvbSBcIm15c3FsMi9wcm9taXNlXCI7XHJcbmltcG9ydCB0eXBlIHsgUG9vbENvbm5lY3Rpb24gfSBmcm9tIFwibXlzcWwyL3Byb21pc2VcIjsgLy8g4oaQIChzb2xvIHRpcG8pXHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g8J+UlyBDb25leGnDs24gYWwgcG9vbCBNeVNRTCAoc2VndXJhLCByZXV0aWxpemFibGUgeSBlc2NhbGFibGUpXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5jb25zdCBwb29sID0gbXlzcWwuY3JlYXRlUG9vbCh7XHJcbiAgaG9zdDogcHJvY2Vzcy5lbnYuREJfSE9TVCB8fCBcImxvY2FsaG9zdFwiLFxyXG4gIHVzZXI6IHByb2Nlc3MuZW52LkRCX1VTRVIgfHwgXCJyb290XCIsXHJcbiAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LkRCX1BBU1MgfHwgXCJcIixcclxuICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuREJfTkFNRSB8fCBcIkFueXNzYW1lZFwiLFxyXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcclxuICBjb25uZWN0aW9uTGltaXQ6IDEwLFxyXG4gIHF1ZXVlTGltaXQ6IDAsXHJcbiAgbXVsdGlwbGVTdGF0ZW1lbnRzOiBmYWxzZSxcclxuICBuYW1lZFBsYWNlaG9sZGVyczogdHJ1ZSxcclxufSk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g8J+nqSBGdW5jacOzbiBnZW7DqXJpY2EgcGFyYSBlamVjdXRhciBjb25zdWx0YXMgc2VndXJhc1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5KHNxbDogc3RyaW5nLCBwYXJhbXM6IGFueVtdID0gW10pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jvd3NdID0gYXdhaXQgcG9vbC5xdWVyeShzcWwsIHBhcmFtcyk7XHJcbiAgICByZXR1cm4gcm93cztcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGVuIHF1ZXJ5IE15U1FMOlwiLCBlcnJvci5tZXNzYWdlKTtcclxuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZW4gY29uc3VsdGE6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDwn5GkIE9idGVuZXIgdXN1YXJpbyBwb3IgZW1haWwgbyB1c2VybmFtZSAocGFyYSBsb2dpbiBvIHZhbGlkYWNpb25lcylcclxuLy8g4pyFIFZlcnNpw7NuIHF1ZSBQUklPUklaQSBlbCByb2wgTcOJRElDTyB5IHNvbG8gdG9tYSByb2xlcyBhY3Rpdm9zXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckJ5RW1haWwoZW1haWxPclVzZXJuYW1lOiBzdHJpbmcpIHtcclxuICBjb25zdCBzcWwgPSBgXHJcbiAgICBTRUxFQ1QgXHJcbiAgICAgIHUuaWRfdXN1YXJpbyxcclxuICAgICAgdS5lbWFpbCxcclxuICAgICAgdS51c2VybmFtZSxcclxuICAgICAgdS5ub21icmUsXHJcbiAgICAgIHUuYXBlbGxpZG9fcGF0ZXJubyxcclxuICAgICAgdS5wYXNzd29yZF9oYXNoLFxyXG4gICAgICAtLSBzaSBubyBoYXkgcm9sLCBkZXZvbHZlbW9zICdTaW4gUm9sJ1xyXG4gICAgICBDT0FMRVNDRShyLm5vbWJyZSwgJ1NpbiBSb2wnKSBBUyByb2xcclxuICAgIEZST00gdXN1YXJpb3MgdVxyXG4gICAgLS0gc29sbyByb2xlcyBhY3Rpdm9zIGRlbCB1c3VhcmlvXHJcbiAgICBMRUZUIEpPSU4gdXN1YXJpb3Nfcm9sZXMgdXIgXHJcbiAgICAgIE9OIHUuaWRfdXN1YXJpbyA9IHVyLmlkX3VzdWFyaW9cclxuICAgICAgQU5EIHVyLmFjdGl2byA9IDFcclxuICAgIC0tIHNvbG8gcm9sZXMgYWN0aXZvcyBlbiBsYSB0YWJsYSByb2xlc1xyXG4gICAgTEVGVCBKT0lOIHJvbGVzIHIgXHJcbiAgICAgIE9OIHVyLmlkX3JvbCA9IHIuaWRfcm9sXHJcbiAgICAgIEFORCByLmVzdGFkbyA9ICdhY3Rpdm8nXHJcbiAgICBXSEVSRSAodS5lbWFpbCA9ID8gT1IgdS51c2VybmFtZSA9ID8pXHJcbiAgICAgIEFORCB1LmVzdGFkbyA9ICdhY3Rpdm8nXHJcbiAgICAtLSBQUklPUklEQUQgZGUgcm9sOlxyXG4gICAgLS0gMSkgbcOpZGljb1xyXG4gICAgLS0gMikgc3VwZXJhZG1pblxyXG4gICAgLS0gMykgYWRtaW4vYWRtaW5pc3RyYXRpdm9cclxuICAgIC0tIDQpIHNlY3JldGFyaWFcclxuICAgIC0tIDUpIHTDqWNuaWNvXHJcbiAgICAtLSA2KSBsbyBxdWUgcXVlZGVcclxuICAgIE9SREVSIEJZXHJcbiAgICAgIENBU0VcclxuICAgICAgICBXSEVOIExPV0VSKHIubm9tYnJlKSBMSUtFICclbWVkaWNvJScgVEhFTiAxXHJcbiAgICAgICAgV0hFTiBMT1dFUihyLm5vbWJyZSkgTElLRSAnJXN1cGVyJScgVEhFTiAyXHJcbiAgICAgICAgV0hFTiBMT1dFUihyLm5vbWJyZSkgTElLRSAnJWFkbWluJScgVEhFTiAzXHJcbiAgICAgICAgV0hFTiBMT1dFUihyLm5vbWJyZSkgTElLRSAnJXNlY3JldCUnIFRIRU4gNFxyXG4gICAgICAgIFdIRU4gTE9XRVIoci5ub21icmUpIExJS0UgJyV0ZWNuaWMlJyBUSEVOIDVcclxuICAgICAgICBFTFNFIDk5XHJcbiAgICAgIEVORCxcclxuICAgICAgci5uaXZlbF9qZXJhcnF1aWEgREVTQ1xyXG4gICAgTElNSVQgMVxyXG4gIGA7XHJcbiAgY29uc3QgW3Jvd3NdOiBhbnkgPSBhd2FpdCBwb29sLnF1ZXJ5KHNxbCwgW2VtYWlsT3JVc2VybmFtZSwgZW1haWxPclVzZXJuYW1lXSk7XHJcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkocm93cykgJiYgcm93cy5sZW5ndGggPiAwID8gcm93c1swXSA6IG51bGw7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDwn5SSIFZlcmlmaWNhciBjcmVkZW5jaWFsZXMgZGVsIHVzdWFyaW9cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlVc2VyQ3JlZGVudGlhbHMoZW1haWxPclVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkSGFzaDogc3RyaW5nKSB7XHJcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldFVzZXJCeUVtYWlsKGVtYWlsT3JVc2VybmFtZSk7XHJcbiAgaWYgKCF1c2VyKSByZXR1cm4gbnVsbDtcclxuICBpZiAodXNlci5wYXNzd29yZF9oYXNoICE9PSBwYXNzd29yZEhhc2gpIHJldHVybiBudWxsO1xyXG4gIHJldHVybiB1c2VyO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g8J+TiiBFamVtcGxvIGRlIHV0aWxpZGFkOiBvYnRlbmVyIGVzdGFkw61zdGljYXMgZ2xvYmFsZXNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHbG9iYWxTdGF0cygpIHtcclxuICBjb25zdCBbW3N0YXRzXV06IGFueSA9IGF3YWl0IHBvb2wucXVlcnkoYFxyXG4gICAgU0VMRUNUIFxyXG4gICAgICAoU0VMRUNUIENPVU5UKCopIEZST00gdXN1YXJpb3MpIEFTIHRvdGFsX3VzdWFyaW9zLFxyXG4gICAgICAoU0VMRUNUIENPVU5UKCopIEZST00gcGFjaWVudGVzKSBBUyB0b3RhbF9wYWNpZW50ZXMsXHJcbiAgICAgIChTRUxFQ1QgQ09VTlQoKikgRlJPTSBtZWRpY29zKSBBUyB0b3RhbF9tZWRpY29zLFxyXG4gICAgICAoU0VMRUNUIENPVU5UKCopIEZST00gY2VudHJvc19tZWRpY29zKSBBUyB0b3RhbF9jZW50cm9zXHJcbiAgYCk7XHJcbiAgcmV0dXJuIHN0YXRzO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g8J+UjCBOVUVWTzogb2J0ZW5lciB1bmEgY29uZXhpw7NuIGRlZGljYWRhIChwYXJhIHRyYW5zYWNjaW9uZXMpXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29ubmVjdGlvbigpOiBQcm9taXNlPFBvb2xDb25uZWN0aW9uPiB7XHJcbiAgY29uc3QgY29ubiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpO1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBjb25uLnBpbmcoKTsgLy8gdmFsaWRhIGxhIGNvbmV4acOzblxyXG4gIH0gY2F0Y2ggKGUpIHtcclxuICAgIGNvbm4ucmVsZWFzZSgpO1xyXG4gICAgdGhyb3cgZTtcclxuICB9XHJcbiAgcmV0dXJuIGNvbm47XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDwn5SBIE5VRVZPIChvcGNpb25hbCk6IGhlbHBlciBwYXJhIGVqZWN1dGFyIGVuIHRyYW5zYWNjacOzblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdpdGhUcmFuc2FjdGlvbjxUPihcclxuICBmbjogKGNvbm46IFBvb2xDb25uZWN0aW9uKSA9PiBQcm9taXNlPFQ+XHJcbik6IFByb21pc2U8VD4ge1xyXG4gIGNvbnN0IGNvbm4gPSBhd2FpdCBnZXRDb25uZWN0aW9uKCk7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IGNvbm4uYmVnaW5UcmFuc2FjdGlvbigpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oY29ubik7XHJcbiAgICBhd2FpdCBjb25uLmNvbW1pdCgpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIHRyeSB7IGF3YWl0IGNvbm4ucm9sbGJhY2soKTsgfSBjYXRjaCB7fVxyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH0gZmluYWxseSB7XHJcbiAgICB0cnkgeyBjb25uLnJlbGVhc2UoKTsgfSBjYXRjaCB7fVxyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIPCflIEgRXhwb3J0YXIgY29uZXhpw7NuIGdsb2JhbFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZXhwb3J0IGRlZmF1bHQgcG9vbDtcclxuXHJcbi8vIChvcGNpb25hbCkgcmUtZXhwb3J0IGRlbCB0aXBvIHBhcmEgdXNhcmxvIGVuIHJ1dGFzIHNpIHF1aWVyZXMgdGlwYXIgcGFyw6FtZXRyb3NcclxuZXhwb3J0IHR5cGUgeyBQb29sQ29ubmVjdGlvbiB9O1xyXG4iXSwibmFtZXMiOlsibXlzcWwiLCJwb29sIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiREJfSE9TVCIsInVzZXIiLCJEQl9VU0VSIiwicGFzc3dvcmQiLCJEQl9QQVNTIiwiZGF0YWJhc2UiLCJEQl9OQU1FIiwid2FpdEZvckNvbm5lY3Rpb25zIiwiY29ubmVjdGlvbkxpbWl0IiwicXVldWVMaW1pdCIsIm11bHRpcGxlU3RhdGVtZW50cyIsIm5hbWVkUGxhY2Vob2xkZXJzIiwicXVlcnkiLCJzcWwiLCJwYXJhbXMiLCJyb3dzIiwiZXJyb3IiLCJjb25zb2xlIiwibWVzc2FnZSIsIkVycm9yIiwiZ2V0VXNlckJ5RW1haWwiLCJlbWFpbE9yVXNlcm5hbWUiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJ2ZXJpZnlVc2VyQ3JlZGVudGlhbHMiLCJwYXNzd29yZEhhc2giLCJwYXNzd29yZF9oYXNoIiwiZ2V0R2xvYmFsU3RhdHMiLCJzdGF0cyIsImdldENvbm5lY3Rpb24iLCJjb25uIiwicGluZyIsImUiLCJyZWxlYXNlIiwid2l0aFRyYW5zYWN0aW9uIiwiZm4iLCJiZWdpblRyYW5zYWN0aW9uIiwicmVzdWx0IiwiY29tbWl0IiwiZXJyIiwicm9sbGJhY2siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/mysql2","vendor-chunks/iconv-lite","vendor-chunks/aws-ssl-profiles","vendor-chunks/long","vendor-chunks/named-placeholders","vendor-chunks/denque","vendor-chunks/is-property","vendor-chunks/lru.min","vendor-chunks/sqlstring","vendor-chunks/seq-queue","vendor-chunks/generate-function","vendor-chunks/safer-buffer"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute&page=%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmedico%2Fagenda%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();