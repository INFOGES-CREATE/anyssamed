/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/medico/pacientes/[id]/route";
exports.ids = ["app/api/medico/pacientes/[id]/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$":
/*!****************************************************!*\
  !*** ./node_modules/mysql2/lib/ sync ^cardinal.*$ ***!
  \****************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "process":
/*!**************************!*\
  !*** external "process" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("string_decoder");

/***/ }),

/***/ "timers":
/*!*************************!*\
  !*** external "timers" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("timers");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute&page=%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute&page=%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_ReactProjects_medisuite_pro_frontend_src_app_api_medico_pacientes_id_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/medico/pacientes/[id]/route.ts */ \"(rsc)/./src/app/api/medico/pacientes/[id]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/medico/pacientes/[id]/route\",\n        pathname: \"/api/medico/pacientes/[id]\",\n        filename: \"route\",\n        bundlePath: \"app/api/medico/pacientes/[id]/route\"\n    },\n    resolvedPagePath: \"C:\\\\ReactProjects\\\\medisuite-pro\\\\frontend\\\\src\\\\app\\\\api\\\\medico\\\\pacientes\\\\[id]\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_ReactProjects_medisuite_pro_frontend_src_app_api_medico_pacientes_id_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/medico/pacientes/[id]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtZWRpY28lMkZwYWNpZW50ZXMlMkYlNUJpZCU1RCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGbWVkaWNvJTJGcGFjaWVudGVzJTJGJTVCaWQlNUQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZtZWRpY28lMkZwYWNpZW50ZXMlMkYlNUJpZCU1RCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDUmVhY3RQcm9qZWN0cyU1Q21lZGlzdWl0ZS1wcm8lNUNmcm9udGVuZCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1JlYWN0UHJvamVjdHMlNUNtZWRpc3VpdGUtcHJvJTVDZnJvbnRlbmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDNEM7QUFDekg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZWRpc3VpdGUtcHJvLz9jOGU2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFJlYWN0UHJvamVjdHNcXFxcbWVkaXN1aXRlLXByb1xcXFxmcm9udGVuZFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxtZWRpY29cXFxccGFjaWVudGVzXFxcXFtpZF1cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL21lZGljby9wYWNpZW50ZXMvW2lkXS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL21lZGljby9wYWNpZW50ZXMvW2lkXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbWVkaWNvL3BhY2llbnRlcy9baWRdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcUmVhY3RQcm9qZWN0c1xcXFxtZWRpc3VpdGUtcHJvXFxcXGZyb250ZW5kXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXG1lZGljb1xcXFxwYWNpZW50ZXNcXFxcW2lkXVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9tZWRpY28vcGFjaWVudGVzL1tpZF0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute&page=%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/medico/pacientes/[id]/route.ts":
/*!****************************************************!*\
  !*** ./src/app/api/medico/pacientes/[id]/route.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n// app/api/medico/pacientes/[id]/route.ts\n\n\n// los mismos candidatos de cookie que usas en la lista\nconst SESSION_COOKIE_CANDIDATES = [\n    \"session\",\n    \"session_token\",\n    \"medisalud_session\",\n    \"auth_session\",\n    \"next-auth.session-token\",\n    \"__Secure-next-auth.session-token\"\n];\nfunction getSessionToken(request) {\n    const cookieHeader = request.headers.get(\"cookie\") || \"\";\n    if (cookieHeader) {\n        const cookies = cookieHeader.split(\";\").map((c)=>c.trim()).filter(Boolean).reduce((acc, c)=>{\n            const [k, ...rest] = c.split(\"=\");\n            acc[k] = rest.join(\"=\");\n            return acc;\n        }, {});\n        for (const name of SESSION_COOKIE_CANDIDATES){\n            if (cookies[name]) {\n                return decodeURIComponent(cookies[name]);\n            }\n        }\n    }\n    const auth = request.headers.get(\"authorization\");\n    if (auth?.startsWith(\"Bearer \")) {\n        return auth.slice(7);\n    }\n    return null;\n}\nasync function obtenerMedicoAutenticado(idUsuario) {\n    const [rows] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n    SELECT \r\n      m.id_medico,\r\n      m.id_usuario,\r\n      m.id_centro_principal,\r\n      m.numero_registro_medico,\r\n      m.titulo_profesional,\r\n      m.especialidad_principal\r\n    FROM medicos m\r\n    WHERE m.id_usuario = ? AND m.estado = 'activo'\r\n    LIMIT 1\r\n    `, [\n        idUsuario\n    ]);\n    if (rows.length === 0) return null;\n    return rows[0];\n}\n// =====================================================\n// GET /api/medico/pacientes/[id]  -> obtener 1 paciente\n// =====================================================\nasync function GET(request, { params }) {\n    try {\n        const idPaciente = Number(params.id);\n        if (!idPaciente) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ID de paciente inv\\xe1lido\"\n            }, {\n                status: 400\n            });\n        }\n        const sessionToken = getSessionToken(request);\n        if (!sessionToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No hay sesi\\xf3n activa\"\n            }, {\n                status: 401\n            });\n        }\n        // validar sesión\n        const [sesiones] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT su.id_usuario\r\n      FROM sesiones_usuarios su\r\n      INNER JOIN usuarios u ON su.id_usuario = u.id_usuario\r\n      WHERE su.token = ?\r\n        AND su.activa = 1\r\n        AND su.fecha_expiracion > NOW()\r\n        AND u.estado = 'activo'\r\n      LIMIT 1\r\n      `, [\n            sessionToken\n        ]);\n        if (sesiones.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Sesi\\xf3n inv\\xe1lida o expirada\"\n            }, {\n                status: 401\n            });\n        }\n        const idUsuario = sesiones[0].id_usuario;\n        const medico = await obtenerMedicoAutenticado(idUsuario);\n        if (!medico) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No tienes un registro de m\\xe9dico activo.\"\n            }, {\n                status: 403\n            });\n        }\n        // actualizar última actividad\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`UPDATE sesiones_usuarios SET ultima_actividad = NOW() WHERE token = ?`, [\n            sessionToken\n        ]);\n        // sacar datos del paciente, asegurando que sea de este médico\n        const [rows] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT \r\n        p.id_paciente,\r\n        p.rut,\r\n        p.nombre,\r\n        p.apellido_paterno,\r\n        p.apellido_materno,\r\n        CONCAT(p.nombre, ' ', p.apellido_paterno, ' ', COALESCE(p.apellido_materno, '')) as nombre_completo,\r\n        p.fecha_nacimiento,\r\n        TIMESTAMPDIFF(YEAR, p.fecha_nacimiento, CURDATE()) as edad,\r\n        p.genero,\r\n        p.email,\r\n        p.telefono,\r\n        p.celular,\r\n        p.direccion,\r\n        p.ciudad,\r\n        p.region,\r\n        p.foto_url,\r\n        p.grupo_sanguineo,\r\n        p.estado,\r\n        p.es_vip,\r\n        p.fecha_registro,\r\n        p.clasificacion_riesgo,\r\n        p.peso_kg,\r\n        p.altura_cm,\r\n        p.imc,\r\n        p.notas_importantes,\r\n        p.tags,\r\n\r\n        -- última consulta con este médico\r\n        (\r\n          SELECT MAX(hc.fecha_atencion)\r\n          FROM historial_clinico hc\r\n          WHERE hc.id_paciente = p.id_paciente\r\n            AND hc.id_medico = ?\r\n            AND hc.estado_registro != 'anulado'\r\n        ) as ultima_consulta,\r\n\r\n        -- próxima cita con este médico\r\n        (\r\n          SELECT MIN(c.fecha_hora_inicio)\r\n          FROM citas c\r\n          WHERE c.id_paciente = p.id_paciente\r\n            AND c.id_medico = ?\r\n            AND c.fecha_hora_inicio > NOW()\r\n            AND c.estado NOT IN ('cancelada', 'no_asistio')\r\n        ) as proxima_cita,\r\n\r\n        -- total consultas con este médico\r\n        (\r\n          SELECT COUNT(*)\r\n          FROM historial_clinico hc\r\n          WHERE hc.id_paciente = p.id_paciente\r\n            AND hc.id_medico = ?\r\n            AND hc.estado_registro != 'anulado'\r\n        ) as total_consultas,\r\n\r\n        -- total citas con este médico\r\n        (\r\n          SELECT COUNT(*)\r\n          FROM citas c\r\n          WHERE c.id_paciente = p.id_paciente\r\n            AND c.id_medico = ?\r\n        ) as total_citas,\r\n\r\n        -- alergias críticas\r\n        (\r\n          SELECT COUNT(*)\r\n          FROM alergias_pacientes ap\r\n          WHERE ap.id_paciente = p.id_paciente\r\n            AND ap.estado = 'activa'\r\n            AND ap.severidad IN ('severa', 'potencialmente_mortal')\r\n        ) as alergias_criticas,\r\n\r\n        -- condiciones crónicas\r\n        (\r\n          SELECT COUNT(*)\r\n          FROM condiciones_cronicas cc\r\n          WHERE cc.id_paciente = p.id_paciente\r\n            AND cc.estado IN ('activa', 'controlada', 'en_tratamiento')\r\n        ) as condiciones_cronicas,\r\n\r\n        -- medicamentos activos (usa tu tabla con fecha_fin_tratamiento)\r\n        (\r\n          SELECT COUNT(DISTINCT rm.id_medicamento)\r\n          FROM receta_medicamentos rm\r\n          INNER JOIN recetas_medicas rec ON rm.id_receta = rec.id_receta\r\n          WHERE rec.id_paciente = p.id_paciente\r\n            AND rec.id_medico = ?\r\n            AND rec.estado = 'activa'\r\n            AND (rec.fecha_fin_tratamiento IS NULL OR rec.fecha_fin_tratamiento >= CURDATE())\r\n        ) as medicamentos_activos,\r\n\r\n        -- exámenes pendientes\r\n        (\r\n          SELECT COUNT(*)\r\n          FROM ordenes_examenes oe\r\n          WHERE oe.id_paciente = p.id_paciente\r\n            AND oe.id_medico = ?\r\n            AND oe.estado IN ('pendiente', 'en_proceso')\r\n        ) as examenes_pendientes,\r\n\r\n        -- documentos pendientes\r\n        (\r\n          SELECT COUNT(*)\r\n          FROM documentos_adjuntos da\r\n          WHERE da.id_paciente = p.id_paciente\r\n            AND da.estado = 'activo'\r\n            AND da.es_publico = 0\r\n        ) as documentos_pendientes,\r\n\r\n        -- diagnóstico principal\r\n        (\r\n          SELECT d.diagnostico\r\n          FROM diagnosticos d\r\n          WHERE d.id_paciente = p.id_paciente\r\n            AND d.id_medico = ?\r\n            AND d.tipo = 'principal'\r\n            AND d.estado IN ('activo', 'cronico', 'en_tratamiento')\r\n          ORDER BY d.fecha_diagnostico DESC\r\n          LIMIT 1\r\n        ) as diagnostico_principal\r\n\r\n      FROM pacientes p\r\n      INNER JOIN pacientes_medico pm ON p.id_paciente = pm.id_paciente\r\n      WHERE p.id_paciente = ?\r\n        AND pm.id_medico = ?\r\n        AND pm.activo = 1\r\n      LIMIT 1\r\n      `, [\n            medico.id_medico,\n            medico.id_medico,\n            medico.id_medico,\n            medico.id_medico,\n            medico.id_medico,\n            medico.id_medico,\n            medico.id_medico,\n            idPaciente,\n            medico.id_medico\n        ]);\n        if (rows.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Paciente no encontrado o no asignado al m\\xe9dico\"\n            }, {\n                status: 404\n            });\n        }\n        const p = rows[0];\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            paciente: {\n                id_paciente: p.id_paciente,\n                rut: p.rut,\n                nombre: p.nombre,\n                apellido_paterno: p.apellido_paterno,\n                apellido_materno: p.apellido_materno,\n                nombre_completo: p.nombre_completo,\n                fecha_nacimiento: p.fecha_nacimiento,\n                edad: p.edad,\n                genero: p.genero,\n                email: p.email,\n                telefono: p.telefono,\n                celular: p.celular,\n                direccion: p.direccion,\n                ciudad: p.ciudad,\n                region: p.region,\n                foto_url: p.foto_url,\n                grupo_sanguineo: p.grupo_sanguineo || \"desconocido\",\n                estado: p.estado,\n                es_vip: Boolean(p.es_vip),\n                fecha_registro: p.fecha_registro,\n                clasificacion_riesgo: p.clasificacion_riesgo,\n                peso_kg: p.peso_kg,\n                altura_cm: p.altura_cm,\n                imc: p.imc,\n                notas_importantes: p.notas_importantes,\n                tags: p.tags ? typeof p.tags === \"string\" ? JSON.parse(p.tags) : p.tags : [],\n                ultima_consulta: p.ultima_consulta,\n                proxima_cita: p.proxima_cita,\n                total_consultas: p.total_consultas || 0,\n                total_citas: p.total_citas || 0,\n                alergias_criticas: p.alergias_criticas || 0,\n                condiciones_cronicas: p.condiciones_cronicas || 0,\n                medicamentos_activos: p.medicamentos_activos || 0,\n                examenes_pendientes: p.examenes_pendientes || 0,\n                documentos_pendientes: p.documentos_pendientes || 0,\n                diagnostico_principal: p.diagnostico_principal\n            }\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"❌ Error en GET /api/medico/pacientes/[id]:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: \"Error interno del servidor\",\n            details:  true ? error.message : 0\n        }, {\n            status: 500\n        });\n    }\n}\n// =====================================================\n// PUT /api/medico/pacientes/[id]  -> actualizar 1 paciente\n// =====================================================\nasync function PUT(request, { params }) {\n    try {\n        const idPaciente = Number(params.id);\n        if (!idPaciente) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ID de paciente inv\\xe1lido\"\n            }, {\n                status: 400\n            });\n        }\n        const sessionToken = getSessionToken(request);\n        if (!sessionToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No hay sesi\\xf3n activa\"\n            }, {\n                status: 401\n            });\n        }\n        // validar sesión\n        const [sesiones] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT su.id_usuario\r\n      FROM sesiones_usuarios su\r\n      INNER JOIN usuarios u ON su.id_usuario = u.id_usuario\r\n      WHERE su.token = ?\r\n        AND su.activa = 1\r\n        AND su.fecha_expiracion > NOW()\r\n        AND u.estado = 'activo'\r\n      LIMIT 1\r\n      `, [\n            sessionToken\n        ]);\n        if (sesiones.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Sesi\\xf3n inv\\xe1lida o expirada\"\n            }, {\n                status: 401\n            });\n        }\n        const idUsuario = sesiones[0].id_usuario;\n        const medico = await obtenerMedicoAutenticado(idUsuario);\n        if (!medico) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No tienes un registro de m\\xe9dico activo.\"\n            }, {\n                status: 403\n            });\n        }\n        // asegurarnos que el paciente está asignado a este médico\n        const [asignacion] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      SELECT 1\r\n      FROM pacientes_medico\r\n      WHERE id_paciente = ? AND id_medico = ? AND activo = 1\r\n      LIMIT 1\r\n      `, [\n            idPaciente,\n            medico.id_medico\n        ]);\n        if (asignacion.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Paciente no asignado a este m\\xe9dico\"\n            }, {\n                status: 403\n            });\n        }\n        const body = await request.json();\n        // los mismos campos que manda tu frontend\n        const { rut, nombre, apellido_paterno, apellido_materno, fecha_nacimiento, genero, email, telefono, celular, direccion, ciudad, region, grupo_sanguineo, es_vip, clasificacion_riesgo, peso_kg, altura_cm, imc, estado_civil, ocupacion, notas_importantes, id_centro_registro } = body;\n        // armamos UPDATE solo con columnas reales de tu tabla `pacientes`\n        const [result] = await _lib_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"].query(`\r\n      UPDATE pacientes\r\n      SET\r\n        rut = ?,\r\n        nombre = ?,\r\n        apellido_paterno = ?,\r\n        apellido_materno = ?,\r\n        fecha_nacimiento = ?,\r\n        genero = ?,\r\n        email = ?,\r\n        telefono = ?,\r\n        celular = ?,\r\n        direccion = ?,\r\n        ciudad = ?,\r\n        region = ?,\r\n        grupo_sanguineo = ?,\r\n        es_vip = ?,\r\n        clasificacion_riesgo = ?,\r\n        peso_kg = ?,\r\n        altura_cm = ?,\r\n        imc = ?,\r\n        estado_civil = ?,\r\n        ocupacion = ?,\r\n        notas_importantes = ?,\r\n        id_centro_registro = ?\r\n      WHERE id_paciente = ?\r\n      LIMIT 1\r\n      `, [\n            rut || null,\n            nombre,\n            apellido_paterno,\n            apellido_materno || null,\n            fecha_nacimiento,\n            genero,\n            email || null,\n            telefono || null,\n            celular || null,\n            direccion || null,\n            ciudad || null,\n            region || null,\n            grupo_sanguineo || \"desconocido\",\n            es_vip ? 1 : 0,\n            clasificacion_riesgo || null,\n            // numéricos a null si vienen vacíos\n            peso_kg !== \"\" && peso_kg !== undefined ? peso_kg : null,\n            altura_cm !== \"\" && altura_cm !== undefined ? altura_cm : null,\n            imc !== \"\" && imc !== undefined ? imc : null,\n            estado_civil || null,\n            ocupacion || null,\n            notas_importantes || null,\n            id_centro_registro || null,\n            idPaciente\n        ]);\n        if (result.affectedRows === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"No se pudo actualizar el paciente\"\n            }, {\n                status: 400\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"❌ Error en PUT /api/medico/pacientes/[id]:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: \"Error al guardar el paciente\",\n            details:  true ? error.message : 0\n        }, {\n            status: 500\n        });\n    }\n}\n// si quieres bloquear DELETE por ahora\nasync function DELETE() {\n    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n        success: false,\n        error: \"M\\xe9todo no permitido\"\n    }, {\n        status: 405\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9tZWRpY28vcGFjaWVudGVzL1tpZF0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSx5Q0FBeUM7QUFDZTtBQUM1QjtBQUc1Qix1REFBdUQ7QUFDdkQsTUFBTUUsNEJBQTRCO0lBQ2hDO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtDQUNEO0FBRUQsU0FBU0MsZ0JBQWdCQyxPQUFvQjtJQUMzQyxNQUFNQyxlQUFlRCxRQUFRRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxhQUFhO0lBRXRELElBQUlGLGNBQWM7UUFDaEIsTUFBTUcsVUFBVUgsYUFDYkksS0FBSyxDQUFDLEtBQ05DLEdBQUcsQ0FBQyxDQUFDQyxJQUFNQSxFQUFFQyxJQUFJLElBQ2pCQyxNQUFNLENBQUNDLFNBQ1BDLE1BQU0sQ0FBQyxDQUFDQyxLQUFLTDtZQUNaLE1BQU0sQ0FBQ00sR0FBRyxHQUFHQyxLQUFLLEdBQUdQLEVBQUVGLEtBQUssQ0FBQztZQUM3Qk8sR0FBRyxDQUFDQyxFQUFFLEdBQUdDLEtBQUtDLElBQUksQ0FBQztZQUNuQixPQUFPSDtRQUNULEdBQUcsQ0FBQztRQUVOLEtBQUssTUFBTUksUUFBUWxCLDBCQUEyQjtZQUM1QyxJQUFJTSxPQUFPLENBQUNZLEtBQUssRUFBRTtnQkFDakIsT0FBT0MsbUJBQW1CYixPQUFPLENBQUNZLEtBQUs7WUFDekM7UUFDRjtJQUNGO0lBRUEsTUFBTUUsT0FBT2xCLFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO0lBQ2pDLElBQUllLE1BQU1DLFdBQVcsWUFBWTtRQUMvQixPQUFPRCxLQUFLRSxLQUFLLENBQUM7SUFDcEI7SUFFQSxPQUFPO0FBQ1Q7QUFXQSxlQUFlQyx5QkFDYkMsU0FBaUI7SUFFakIsTUFBTSxDQUFDQyxLQUFLLEdBQUcsTUFBTTFCLHFEQUFVLENBQzdCLENBQUM7Ozs7Ozs7Ozs7O0lBV0QsQ0FBQyxFQUNEO1FBQUN5QjtLQUFVO0lBR2IsSUFBSUMsS0FBS0UsTUFBTSxLQUFLLEdBQUcsT0FBTztJQUM5QixPQUFPRixJQUFJLENBQUMsRUFBRTtBQUNoQjtBQUVBLHdEQUF3RDtBQUN4RCx3REFBd0Q7QUFDeEQsd0RBQXdEO0FBQ2pELGVBQWVHLElBQ3BCMUIsT0FBb0IsRUFDcEIsRUFBRTJCLE1BQU0sRUFBOEI7SUFFdEMsSUFBSTtRQUNGLE1BQU1DLGFBQWFDLE9BQU9GLE9BQU9HLEVBQUU7UUFDbkMsSUFBSSxDQUFDRixZQUFZO1lBQ2YsT0FBT2hDLGtGQUFZQSxDQUFDbUMsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0MsT0FBTztZQUEwQixHQUNuRDtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTUMsZUFBZXBDLGdCQUFnQkM7UUFDckMsSUFBSSxDQUFDbUMsY0FBYztZQUNqQixPQUFPdkMsa0ZBQVlBLENBQUNtQyxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO1lBQXVCLEdBQ2hEO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxpQkFBaUI7UUFDakIsTUFBTSxDQUFDRSxTQUFTLEdBQUcsTUFBTXZDLHFEQUFVLENBQ2pDLENBQUM7Ozs7Ozs7OztNQVNELENBQUMsRUFDRDtZQUFDc0M7U0FBYTtRQUdoQixJQUFJQyxTQUFTWCxNQUFNLEtBQUssR0FBRztZQUN6QixPQUFPN0Isa0ZBQVlBLENBQUNtQyxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO1lBQTZCLEdBQ3REO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNWixZQUFZYyxRQUFRLENBQUMsRUFBRSxDQUFDQyxVQUFVO1FBQ3hDLE1BQU1DLFNBQVMsTUFBTWpCLHlCQUF5QkM7UUFFOUMsSUFBSSxDQUFDZ0IsUUFBUTtZQUNYLE9BQU8xQyxrRkFBWUEsQ0FBQ21DLElBQUksQ0FDdEI7Z0JBQ0VDLFNBQVM7Z0JBQ1RDLE9BQU87WUFDVCxHQUNBO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSw4QkFBOEI7UUFDOUIsTUFBTXJDLHFEQUFVLENBQ2QsQ0FBQyxxRUFBcUUsQ0FBQyxFQUN2RTtZQUFDc0M7U0FBYTtRQUdoQiw4REFBOEQ7UUFDOUQsTUFBTSxDQUFDWixLQUFLLEdBQUcsTUFBTTFCLHFEQUFVLENBQzdCLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztNQWlJRCxDQUFDLEVBQ0Q7WUFDRXlDLE9BQU9DLFNBQVM7WUFDaEJELE9BQU9DLFNBQVM7WUFDaEJELE9BQU9DLFNBQVM7WUFDaEJELE9BQU9DLFNBQVM7WUFDaEJELE9BQU9DLFNBQVM7WUFDaEJELE9BQU9DLFNBQVM7WUFDaEJELE9BQU9DLFNBQVM7WUFDaEJYO1lBQ0FVLE9BQU9DLFNBQVM7U0FDakI7UUFHSCxJQUFJaEIsS0FBS0UsTUFBTSxLQUFLLEdBQUc7WUFDckIsT0FBTzdCLGtGQUFZQSxDQUFDbUMsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0MsT0FBTztZQUFpRCxHQUMxRTtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTU0sSUFBSWpCLElBQUksQ0FBQyxFQUFFO1FBRWpCLE9BQU8zQixrRkFBWUEsQ0FBQ21DLElBQUksQ0FDdEI7WUFDRUMsU0FBUztZQUNUUyxVQUFVO2dCQUNSQyxhQUFhRixFQUFFRSxXQUFXO2dCQUMxQkMsS0FBS0gsRUFBRUcsR0FBRztnQkFDVkMsUUFBUUosRUFBRUksTUFBTTtnQkFDaEJDLGtCQUFrQkwsRUFBRUssZ0JBQWdCO2dCQUNwQ0Msa0JBQWtCTixFQUFFTSxnQkFBZ0I7Z0JBQ3BDQyxpQkFBaUJQLEVBQUVPLGVBQWU7Z0JBQ2xDQyxrQkFBa0JSLEVBQUVRLGdCQUFnQjtnQkFDcENDLE1BQU1ULEVBQUVTLElBQUk7Z0JBQ1pDLFFBQVFWLEVBQUVVLE1BQU07Z0JBQ2hCQyxPQUFPWCxFQUFFVyxLQUFLO2dCQUNkQyxVQUFVWixFQUFFWSxRQUFRO2dCQUNwQkMsU0FBU2IsRUFBRWEsT0FBTztnQkFDbEJDLFdBQVdkLEVBQUVjLFNBQVM7Z0JBQ3RCQyxRQUFRZixFQUFFZSxNQUFNO2dCQUNoQkMsUUFBUWhCLEVBQUVnQixNQUFNO2dCQUNoQkMsVUFBVWpCLEVBQUVpQixRQUFRO2dCQUNwQkMsaUJBQWlCbEIsRUFBRWtCLGVBQWUsSUFBSTtnQkFDdENDLFFBQVFuQixFQUFFbUIsTUFBTTtnQkFDaEJDLFFBQVFsRCxRQUFROEIsRUFBRW9CLE1BQU07Z0JBQ3hCQyxnQkFBZ0JyQixFQUFFcUIsY0FBYztnQkFDaENDLHNCQUFzQnRCLEVBQUVzQixvQkFBb0I7Z0JBQzVDQyxTQUFTdkIsRUFBRXVCLE9BQU87Z0JBQ2xCQyxXQUFXeEIsRUFBRXdCLFNBQVM7Z0JBQ3RCQyxLQUFLekIsRUFBRXlCLEdBQUc7Z0JBQ1ZDLG1CQUFtQjFCLEVBQUUwQixpQkFBaUI7Z0JBQ3RDQyxNQUFNM0IsRUFBRTJCLElBQUksR0FDUixPQUFPM0IsRUFBRTJCLElBQUksS0FBSyxXQUNoQkMsS0FBS0MsS0FBSyxDQUFDN0IsRUFBRTJCLElBQUksSUFDakIzQixFQUFFMkIsSUFBSSxHQUNSLEVBQUU7Z0JBQ05HLGlCQUFpQjlCLEVBQUU4QixlQUFlO2dCQUNsQ0MsY0FBYy9CLEVBQUUrQixZQUFZO2dCQUM1QkMsaUJBQWlCaEMsRUFBRWdDLGVBQWUsSUFBSTtnQkFDdENDLGFBQWFqQyxFQUFFaUMsV0FBVyxJQUFJO2dCQUM5QkMsbUJBQW1CbEMsRUFBRWtDLGlCQUFpQixJQUFJO2dCQUMxQ0Msc0JBQXNCbkMsRUFBRW1DLG9CQUFvQixJQUFJO2dCQUNoREMsc0JBQXNCcEMsRUFBRW9DLG9CQUFvQixJQUFJO2dCQUNoREMscUJBQXFCckMsRUFBRXFDLG1CQUFtQixJQUFJO2dCQUM5Q0MsdUJBQXVCdEMsRUFBRXNDLHFCQUFxQixJQUFJO2dCQUNsREMsdUJBQXVCdkMsRUFBRXVDLHFCQUFxQjtZQUNoRDtRQUNGLEdBQ0E7WUFBRTdDLFFBQVE7UUFBSTtJQUVsQixFQUFFLE9BQU9ELE9BQVk7UUFDbkIrQyxRQUFRL0MsS0FBSyxDQUFDLDhDQUE4Q0E7UUFDNUQsT0FBT3JDLGtGQUFZQSxDQUFDbUMsSUFBSSxDQUN0QjtZQUNFQyxTQUFTO1lBQ1RDLE9BQU87WUFDUGdELFNBQ0VDLEtBQXNDLEdBQUdqRCxNQUFNa0QsT0FBTyxHQUFHQyxDQUFTQTtRQUN0RSxHQUNBO1lBQUVsRCxRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVBLHdEQUF3RDtBQUN4RCwyREFBMkQ7QUFDM0Qsd0RBQXdEO0FBQ2pELGVBQWVtRCxJQUNwQnJGLE9BQW9CLEVBQ3BCLEVBQUUyQixNQUFNLEVBQThCO0lBRXRDLElBQUk7UUFDRixNQUFNQyxhQUFhQyxPQUFPRixPQUFPRyxFQUFFO1FBQ25DLElBQUksQ0FBQ0YsWUFBWTtZQUNmLE9BQU9oQyxrRkFBWUEsQ0FBQ21DLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9DLE9BQU87WUFBMEIsR0FDbkQ7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1DLGVBQWVwQyxnQkFBZ0JDO1FBQ3JDLElBQUksQ0FBQ21DLGNBQWM7WUFDakIsT0FBT3ZDLGtGQUFZQSxDQUFDbUMsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0MsT0FBTztZQUF1QixHQUNoRDtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsaUJBQWlCO1FBQ2pCLE1BQU0sQ0FBQ0UsU0FBUyxHQUFHLE1BQU12QyxxREFBVSxDQUNqQyxDQUFDOzs7Ozs7Ozs7TUFTRCxDQUFDLEVBQ0Q7WUFBQ3NDO1NBQWE7UUFHaEIsSUFBSUMsU0FBU1gsTUFBTSxLQUFLLEdBQUc7WUFDekIsT0FBTzdCLGtGQUFZQSxDQUFDbUMsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0MsT0FBTztZQUE2QixHQUN0RDtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTVosWUFBWWMsUUFBUSxDQUFDLEVBQUUsQ0FBQ0MsVUFBVTtRQUN4QyxNQUFNQyxTQUFTLE1BQU1qQix5QkFBeUJDO1FBRTlDLElBQUksQ0FBQ2dCLFFBQVE7WUFDWCxPQUFPMUMsa0ZBQVlBLENBQUNtQyxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO1lBQTBDLEdBQ25FO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSwwREFBMEQ7UUFDMUQsTUFBTSxDQUFDb0QsV0FBVyxHQUFHLE1BQU16RixxREFBVSxDQUNuQyxDQUFDOzs7OztNQUtELENBQUMsRUFDRDtZQUFDK0I7WUFBWVUsT0FBT0MsU0FBUztTQUFDO1FBR2hDLElBQUkrQyxXQUFXN0QsTUFBTSxLQUFLLEdBQUc7WUFDM0IsT0FBTzdCLGtGQUFZQSxDQUFDbUMsSUFBSSxDQUN0QjtnQkFDRUMsU0FBUztnQkFDVEMsT0FBTztZQUNULEdBQ0E7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1xRCxPQUFPLE1BQU12RixRQUFRK0IsSUFBSTtRQUUvQiwwQ0FBMEM7UUFDMUMsTUFBTSxFQUNKWSxHQUFHLEVBQ0hDLE1BQU0sRUFDTkMsZ0JBQWdCLEVBQ2hCQyxnQkFBZ0IsRUFDaEJFLGdCQUFnQixFQUNoQkUsTUFBTSxFQUNOQyxLQUFLLEVBQ0xDLFFBQVEsRUFDUkMsT0FBTyxFQUNQQyxTQUFTLEVBQ1RDLE1BQU0sRUFDTkMsTUFBTSxFQUNORSxlQUFlLEVBQ2ZFLE1BQU0sRUFDTkUsb0JBQW9CLEVBQ3BCQyxPQUFPLEVBQ1BDLFNBQVMsRUFDVEMsR0FBRyxFQUNIdUIsWUFBWSxFQUNaQyxTQUFTLEVBQ1R2QixpQkFBaUIsRUFDakJ3QixrQkFBa0IsRUFDbkIsR0FBR0g7UUFFSixrRUFBa0U7UUFDbEUsTUFBTSxDQUFDSSxPQUFPLEdBQUcsTUFBTTlGLHFEQUFVLENBQy9CLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztNQTJCRCxDQUFDLEVBQ0Q7WUFDRThDLE9BQU87WUFDUEM7WUFDQUM7WUFDQUMsb0JBQW9CO1lBQ3BCRTtZQUNBRTtZQUNBQyxTQUFTO1lBQ1RDLFlBQVk7WUFDWkMsV0FBVztZQUNYQyxhQUFhO1lBQ2JDLFVBQVU7WUFDVkMsVUFBVTtZQUNWRSxtQkFBbUI7WUFDbkJFLFNBQVMsSUFBSTtZQUNiRSx3QkFBd0I7WUFDeEIsb0NBQW9DO1lBQ3BDQyxZQUFZLE1BQU1BLFlBQVlxQixZQUFZckIsVUFBVTtZQUNwREMsY0FBYyxNQUFNQSxjQUFjb0IsWUFBWXBCLFlBQVk7WUFDMURDLFFBQVEsTUFBTUEsUUFBUW1CLFlBQVluQixNQUFNO1lBQ3hDdUIsZ0JBQWdCO1lBQ2hCQyxhQUFhO1lBQ2J2QixxQkFBcUI7WUFDckJ3QixzQkFBc0I7WUFDdEI5RDtTQUNEO1FBR0gsSUFBSStELE9BQU9DLFlBQVksS0FBSyxHQUFHO1lBQzdCLE9BQU9oRyxrRkFBWUEsQ0FBQ21DLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9DLE9BQU87WUFBb0MsR0FDN0Q7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE9BQU90QyxrRkFBWUEsQ0FBQ21DLElBQUksQ0FBQztZQUFFQyxTQUFTO1FBQUssR0FBRztZQUFFRSxRQUFRO1FBQUk7SUFDNUQsRUFBRSxPQUFPRCxPQUFZO1FBQ25CK0MsUUFBUS9DLEtBQUssQ0FBQyw4Q0FBOENBO1FBQzVELE9BQU9yQyxrRkFBWUEsQ0FBQ21DLElBQUksQ0FDdEI7WUFDRUMsU0FBUztZQUNUQyxPQUFPO1lBQ1BnRCxTQUNFQyxLQUFzQyxHQUFHakQsTUFBTWtELE9BQU8sR0FBR0MsQ0FBU0E7UUFDdEUsR0FDQTtZQUFFbEQsUUFBUTtRQUFJO0lBRWxCO0FBQ0Y7QUFFQSx1Q0FBdUM7QUFDaEMsZUFBZTJEO0lBQ3BCLE9BQU9qRyxrRkFBWUEsQ0FBQ21DLElBQUksQ0FDdEI7UUFBRUMsU0FBUztRQUFPQyxPQUFPO0lBQXNCLEdBQy9DO1FBQUVDLFFBQVE7SUFBSTtBQUVsQiIsInNvdXJjZXMiOlsid2VicGFjazovL21lZGlzdWl0ZS1wcm8vLi9zcmMvYXBwL2FwaS9tZWRpY28vcGFjaWVudGVzL1tpZF0vcm91dGUudHM/M2Q0NyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhcHAvYXBpL21lZGljby9wYWNpZW50ZXMvW2lkXS9yb3V0ZS50c1xyXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCBwb29sIGZyb20gXCJAL2xpYi9kYlwiO1xyXG5pbXBvcnQgeyBSb3dEYXRhUGFja2V0LCBSZXN1bHRTZXRIZWFkZXIgfSBmcm9tIFwibXlzcWwyXCI7XHJcblxyXG4vLyBsb3MgbWlzbW9zIGNhbmRpZGF0b3MgZGUgY29va2llIHF1ZSB1c2FzIGVuIGxhIGxpc3RhXHJcbmNvbnN0IFNFU1NJT05fQ09PS0lFX0NBTkRJREFURVMgPSBbXHJcbiAgXCJzZXNzaW9uXCIsXHJcbiAgXCJzZXNzaW9uX3Rva2VuXCIsXHJcbiAgXCJtZWRpc2FsdWRfc2Vzc2lvblwiLFxyXG4gIFwiYXV0aF9zZXNzaW9uXCIsXHJcbiAgXCJuZXh0LWF1dGguc2Vzc2lvbi10b2tlblwiLFxyXG4gIFwiX19TZWN1cmUtbmV4dC1hdXRoLnNlc3Npb24tdG9rZW5cIixcclxuXTtcclxuXHJcbmZ1bmN0aW9uIGdldFNlc3Npb25Ub2tlbihyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IHN0cmluZyB8IG51bGwge1xyXG4gIGNvbnN0IGNvb2tpZUhlYWRlciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJjb29raWVcIikgfHwgXCJcIjtcclxuXHJcbiAgaWYgKGNvb2tpZUhlYWRlcikge1xyXG4gICAgY29uc3QgY29va2llcyA9IGNvb2tpZUhlYWRlclxyXG4gICAgICAuc3BsaXQoXCI7XCIpXHJcbiAgICAgIC5tYXAoKGMpID0+IGMudHJpbSgpKVxyXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pXHJcbiAgICAgIC5yZWR1Y2UoKGFjYywgYykgPT4ge1xyXG4gICAgICAgIGNvbnN0IFtrLCAuLi5yZXN0XSA9IGMuc3BsaXQoXCI9XCIpO1xyXG4gICAgICAgIGFjY1trXSA9IHJlc3Quam9pbihcIj1cIik7XHJcbiAgICAgICAgcmV0dXJuIGFjYztcclxuICAgICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPik7XHJcblxyXG4gICAgZm9yIChjb25zdCBuYW1lIG9mIFNFU1NJT05fQ09PS0lFX0NBTkRJREFURVMpIHtcclxuICAgICAgaWYgKGNvb2tpZXNbbmFtZV0pIHtcclxuICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGNvb2tpZXNbbmFtZV0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdCBhdXRoID0gcmVxdWVzdC5oZWFkZXJzLmdldChcImF1dGhvcml6YXRpb25cIik7XHJcbiAgaWYgKGF1dGg/LnN0YXJ0c1dpdGgoXCJCZWFyZXIgXCIpKSB7XHJcbiAgICByZXR1cm4gYXV0aC5zbGljZSg3KTtcclxuICB9XHJcblxyXG4gIHJldHVybiBudWxsO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgTWVkaWNvRGF0YSB7XHJcbiAgaWRfbWVkaWNvOiBudW1iZXI7XHJcbiAgaWRfdXN1YXJpbzogbnVtYmVyO1xyXG4gIGlkX2NlbnRyb19wcmluY2lwYWw6IG51bWJlcjtcclxuICBudW1lcm9fcmVnaXN0cm9fbWVkaWNvOiBzdHJpbmc7XHJcbiAgdGl0dWxvX3Byb2Zlc2lvbmFsOiBzdHJpbmc7XHJcbiAgZXNwZWNpYWxpZGFkX3ByaW5jaXBhbDogc3RyaW5nO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBvYnRlbmVyTWVkaWNvQXV0ZW50aWNhZG8oXHJcbiAgaWRVc3VhcmlvOiBudW1iZXJcclxuKTogUHJvbWlzZTxNZWRpY29EYXRhIHwgbnVsbD4ge1xyXG4gIGNvbnN0IFtyb3dzXSA9IGF3YWl0IHBvb2wucXVlcnk8Um93RGF0YVBhY2tldFtdPihcclxuICAgIGBcclxuICAgIFNFTEVDVCBcclxuICAgICAgbS5pZF9tZWRpY28sXHJcbiAgICAgIG0uaWRfdXN1YXJpbyxcclxuICAgICAgbS5pZF9jZW50cm9fcHJpbmNpcGFsLFxyXG4gICAgICBtLm51bWVyb19yZWdpc3Ryb19tZWRpY28sXHJcbiAgICAgIG0udGl0dWxvX3Byb2Zlc2lvbmFsLFxyXG4gICAgICBtLmVzcGVjaWFsaWRhZF9wcmluY2lwYWxcclxuICAgIEZST00gbWVkaWNvcyBtXHJcbiAgICBXSEVSRSBtLmlkX3VzdWFyaW8gPSA/IEFORCBtLmVzdGFkbyA9ICdhY3Rpdm8nXHJcbiAgICBMSU1JVCAxXHJcbiAgICBgLFxyXG4gICAgW2lkVXN1YXJpb11cclxuICApO1xyXG5cclxuICBpZiAocm93cy5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xyXG4gIHJldHVybiByb3dzWzBdIGFzIE1lZGljb0RhdGE7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEdFVCAvYXBpL21lZGljby9wYWNpZW50ZXMvW2lkXSAgLT4gb2J0ZW5lciAxIHBhY2llbnRlXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXHJcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXHJcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cclxuKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGlkUGFjaWVudGUgPSBOdW1iZXIocGFyYW1zLmlkKTtcclxuICAgIGlmICghaWRQYWNpZW50ZSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSUQgZGUgcGFjaWVudGUgaW52w6FsaWRvXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZXNzaW9uVG9rZW4gPSBnZXRTZXNzaW9uVG9rZW4ocmVxdWVzdCk7XHJcbiAgICBpZiAoIXNlc3Npb25Ub2tlbikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTm8gaGF5IHNlc2nDs24gYWN0aXZhXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAxIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2YWxpZGFyIHNlc2nDs25cclxuICAgIGNvbnN0IFtzZXNpb25lc10gPSBhd2FpdCBwb29sLnF1ZXJ5PFJvd0RhdGFQYWNrZXRbXT4oXHJcbiAgICAgIGBcclxuICAgICAgU0VMRUNUIHN1LmlkX3VzdWFyaW9cclxuICAgICAgRlJPTSBzZXNpb25lc191c3VhcmlvcyBzdVxyXG4gICAgICBJTk5FUiBKT0lOIHVzdWFyaW9zIHUgT04gc3UuaWRfdXN1YXJpbyA9IHUuaWRfdXN1YXJpb1xyXG4gICAgICBXSEVSRSBzdS50b2tlbiA9ID9cclxuICAgICAgICBBTkQgc3UuYWN0aXZhID0gMVxyXG4gICAgICAgIEFORCBzdS5mZWNoYV9leHBpcmFjaW9uID4gTk9XKClcclxuICAgICAgICBBTkQgdS5lc3RhZG8gPSAnYWN0aXZvJ1xyXG4gICAgICBMSU1JVCAxXHJcbiAgICAgIGAsXHJcbiAgICAgIFtzZXNzaW9uVG9rZW5dXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChzZXNpb25lcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlNlc2nDs24gaW52w6FsaWRhIG8gZXhwaXJhZGFcIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGlkVXN1YXJpbyA9IHNlc2lvbmVzWzBdLmlkX3VzdWFyaW87XHJcbiAgICBjb25zdCBtZWRpY28gPSBhd2FpdCBvYnRlbmVyTWVkaWNvQXV0ZW50aWNhZG8oaWRVc3VhcmlvKTtcclxuXHJcbiAgICBpZiAoIW1lZGljbykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogXCJObyB0aWVuZXMgdW4gcmVnaXN0cm8gZGUgbcOpZGljbyBhY3Rpdm8uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAzIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBhY3R1YWxpemFyIMO6bHRpbWEgYWN0aXZpZGFkXHJcbiAgICBhd2FpdCBwb29sLnF1ZXJ5KFxyXG4gICAgICBgVVBEQVRFIHNlc2lvbmVzX3VzdWFyaW9zIFNFVCB1bHRpbWFfYWN0aXZpZGFkID0gTk9XKCkgV0hFUkUgdG9rZW4gPSA/YCxcclxuICAgICAgW3Nlc3Npb25Ub2tlbl1cclxuICAgICk7XHJcblxyXG4gICAgLy8gc2FjYXIgZGF0b3MgZGVsIHBhY2llbnRlLCBhc2VndXJhbmRvIHF1ZSBzZWEgZGUgZXN0ZSBtw6lkaWNvXHJcbiAgICBjb25zdCBbcm93c10gPSBhd2FpdCBwb29sLnF1ZXJ5PFJvd0RhdGFQYWNrZXRbXT4oXHJcbiAgICAgIGBcclxuICAgICAgU0VMRUNUIFxyXG4gICAgICAgIHAuaWRfcGFjaWVudGUsXHJcbiAgICAgICAgcC5ydXQsXHJcbiAgICAgICAgcC5ub21icmUsXHJcbiAgICAgICAgcC5hcGVsbGlkb19wYXRlcm5vLFxyXG4gICAgICAgIHAuYXBlbGxpZG9fbWF0ZXJubyxcclxuICAgICAgICBDT05DQVQocC5ub21icmUsICcgJywgcC5hcGVsbGlkb19wYXRlcm5vLCAnICcsIENPQUxFU0NFKHAuYXBlbGxpZG9fbWF0ZXJubywgJycpKSBhcyBub21icmVfY29tcGxldG8sXHJcbiAgICAgICAgcC5mZWNoYV9uYWNpbWllbnRvLFxyXG4gICAgICAgIFRJTUVTVEFNUERJRkYoWUVBUiwgcC5mZWNoYV9uYWNpbWllbnRvLCBDVVJEQVRFKCkpIGFzIGVkYWQsXHJcbiAgICAgICAgcC5nZW5lcm8sXHJcbiAgICAgICAgcC5lbWFpbCxcclxuICAgICAgICBwLnRlbGVmb25vLFxyXG4gICAgICAgIHAuY2VsdWxhcixcclxuICAgICAgICBwLmRpcmVjY2lvbixcclxuICAgICAgICBwLmNpdWRhZCxcclxuICAgICAgICBwLnJlZ2lvbixcclxuICAgICAgICBwLmZvdG9fdXJsLFxyXG4gICAgICAgIHAuZ3J1cG9fc2FuZ3VpbmVvLFxyXG4gICAgICAgIHAuZXN0YWRvLFxyXG4gICAgICAgIHAuZXNfdmlwLFxyXG4gICAgICAgIHAuZmVjaGFfcmVnaXN0cm8sXHJcbiAgICAgICAgcC5jbGFzaWZpY2FjaW9uX3JpZXNnbyxcclxuICAgICAgICBwLnBlc29fa2csXHJcbiAgICAgICAgcC5hbHR1cmFfY20sXHJcbiAgICAgICAgcC5pbWMsXHJcbiAgICAgICAgcC5ub3Rhc19pbXBvcnRhbnRlcyxcclxuICAgICAgICBwLnRhZ3MsXHJcblxyXG4gICAgICAgIC0tIMO6bHRpbWEgY29uc3VsdGEgY29uIGVzdGUgbcOpZGljb1xyXG4gICAgICAgIChcclxuICAgICAgICAgIFNFTEVDVCBNQVgoaGMuZmVjaGFfYXRlbmNpb24pXHJcbiAgICAgICAgICBGUk9NIGhpc3RvcmlhbF9jbGluaWNvIGhjXHJcbiAgICAgICAgICBXSEVSRSBoYy5pZF9wYWNpZW50ZSA9IHAuaWRfcGFjaWVudGVcclxuICAgICAgICAgICAgQU5EIGhjLmlkX21lZGljbyA9ID9cclxuICAgICAgICAgICAgQU5EIGhjLmVzdGFkb19yZWdpc3RybyAhPSAnYW51bGFkbydcclxuICAgICAgICApIGFzIHVsdGltYV9jb25zdWx0YSxcclxuXHJcbiAgICAgICAgLS0gcHLDs3hpbWEgY2l0YSBjb24gZXN0ZSBtw6lkaWNvXHJcbiAgICAgICAgKFxyXG4gICAgICAgICAgU0VMRUNUIE1JTihjLmZlY2hhX2hvcmFfaW5pY2lvKVxyXG4gICAgICAgICAgRlJPTSBjaXRhcyBjXHJcbiAgICAgICAgICBXSEVSRSBjLmlkX3BhY2llbnRlID0gcC5pZF9wYWNpZW50ZVxyXG4gICAgICAgICAgICBBTkQgYy5pZF9tZWRpY28gPSA/XHJcbiAgICAgICAgICAgIEFORCBjLmZlY2hhX2hvcmFfaW5pY2lvID4gTk9XKClcclxuICAgICAgICAgICAgQU5EIGMuZXN0YWRvIE5PVCBJTiAoJ2NhbmNlbGFkYScsICdub19hc2lzdGlvJylcclxuICAgICAgICApIGFzIHByb3hpbWFfY2l0YSxcclxuXHJcbiAgICAgICAgLS0gdG90YWwgY29uc3VsdGFzIGNvbiBlc3RlIG3DqWRpY29cclxuICAgICAgICAoXHJcbiAgICAgICAgICBTRUxFQ1QgQ09VTlQoKilcclxuICAgICAgICAgIEZST00gaGlzdG9yaWFsX2NsaW5pY28gaGNcclxuICAgICAgICAgIFdIRVJFIGhjLmlkX3BhY2llbnRlID0gcC5pZF9wYWNpZW50ZVxyXG4gICAgICAgICAgICBBTkQgaGMuaWRfbWVkaWNvID0gP1xyXG4gICAgICAgICAgICBBTkQgaGMuZXN0YWRvX3JlZ2lzdHJvICE9ICdhbnVsYWRvJ1xyXG4gICAgICAgICkgYXMgdG90YWxfY29uc3VsdGFzLFxyXG5cclxuICAgICAgICAtLSB0b3RhbCBjaXRhcyBjb24gZXN0ZSBtw6lkaWNvXHJcbiAgICAgICAgKFxyXG4gICAgICAgICAgU0VMRUNUIENPVU5UKCopXHJcbiAgICAgICAgICBGUk9NIGNpdGFzIGNcclxuICAgICAgICAgIFdIRVJFIGMuaWRfcGFjaWVudGUgPSBwLmlkX3BhY2llbnRlXHJcbiAgICAgICAgICAgIEFORCBjLmlkX21lZGljbyA9ID9cclxuICAgICAgICApIGFzIHRvdGFsX2NpdGFzLFxyXG5cclxuICAgICAgICAtLSBhbGVyZ2lhcyBjcsOtdGljYXNcclxuICAgICAgICAoXHJcbiAgICAgICAgICBTRUxFQ1QgQ09VTlQoKilcclxuICAgICAgICAgIEZST00gYWxlcmdpYXNfcGFjaWVudGVzIGFwXHJcbiAgICAgICAgICBXSEVSRSBhcC5pZF9wYWNpZW50ZSA9IHAuaWRfcGFjaWVudGVcclxuICAgICAgICAgICAgQU5EIGFwLmVzdGFkbyA9ICdhY3RpdmEnXHJcbiAgICAgICAgICAgIEFORCBhcC5zZXZlcmlkYWQgSU4gKCdzZXZlcmEnLCAncG90ZW5jaWFsbWVudGVfbW9ydGFsJylcclxuICAgICAgICApIGFzIGFsZXJnaWFzX2NyaXRpY2FzLFxyXG5cclxuICAgICAgICAtLSBjb25kaWNpb25lcyBjcsOzbmljYXNcclxuICAgICAgICAoXHJcbiAgICAgICAgICBTRUxFQ1QgQ09VTlQoKilcclxuICAgICAgICAgIEZST00gY29uZGljaW9uZXNfY3JvbmljYXMgY2NcclxuICAgICAgICAgIFdIRVJFIGNjLmlkX3BhY2llbnRlID0gcC5pZF9wYWNpZW50ZVxyXG4gICAgICAgICAgICBBTkQgY2MuZXN0YWRvIElOICgnYWN0aXZhJywgJ2NvbnRyb2xhZGEnLCAnZW5fdHJhdGFtaWVudG8nKVxyXG4gICAgICAgICkgYXMgY29uZGljaW9uZXNfY3JvbmljYXMsXHJcblxyXG4gICAgICAgIC0tIG1lZGljYW1lbnRvcyBhY3Rpdm9zICh1c2EgdHUgdGFibGEgY29uIGZlY2hhX2Zpbl90cmF0YW1pZW50bylcclxuICAgICAgICAoXHJcbiAgICAgICAgICBTRUxFQ1QgQ09VTlQoRElTVElOQ1Qgcm0uaWRfbWVkaWNhbWVudG8pXHJcbiAgICAgICAgICBGUk9NIHJlY2V0YV9tZWRpY2FtZW50b3Mgcm1cclxuICAgICAgICAgIElOTkVSIEpPSU4gcmVjZXRhc19tZWRpY2FzIHJlYyBPTiBybS5pZF9yZWNldGEgPSByZWMuaWRfcmVjZXRhXHJcbiAgICAgICAgICBXSEVSRSByZWMuaWRfcGFjaWVudGUgPSBwLmlkX3BhY2llbnRlXHJcbiAgICAgICAgICAgIEFORCByZWMuaWRfbWVkaWNvID0gP1xyXG4gICAgICAgICAgICBBTkQgcmVjLmVzdGFkbyA9ICdhY3RpdmEnXHJcbiAgICAgICAgICAgIEFORCAocmVjLmZlY2hhX2Zpbl90cmF0YW1pZW50byBJUyBOVUxMIE9SIHJlYy5mZWNoYV9maW5fdHJhdGFtaWVudG8gPj0gQ1VSREFURSgpKVxyXG4gICAgICAgICkgYXMgbWVkaWNhbWVudG9zX2FjdGl2b3MsXHJcblxyXG4gICAgICAgIC0tIGV4w6FtZW5lcyBwZW5kaWVudGVzXHJcbiAgICAgICAgKFxyXG4gICAgICAgICAgU0VMRUNUIENPVU5UKCopXHJcbiAgICAgICAgICBGUk9NIG9yZGVuZXNfZXhhbWVuZXMgb2VcclxuICAgICAgICAgIFdIRVJFIG9lLmlkX3BhY2llbnRlID0gcC5pZF9wYWNpZW50ZVxyXG4gICAgICAgICAgICBBTkQgb2UuaWRfbWVkaWNvID0gP1xyXG4gICAgICAgICAgICBBTkQgb2UuZXN0YWRvIElOICgncGVuZGllbnRlJywgJ2VuX3Byb2Nlc28nKVxyXG4gICAgICAgICkgYXMgZXhhbWVuZXNfcGVuZGllbnRlcyxcclxuXHJcbiAgICAgICAgLS0gZG9jdW1lbnRvcyBwZW5kaWVudGVzXHJcbiAgICAgICAgKFxyXG4gICAgICAgICAgU0VMRUNUIENPVU5UKCopXHJcbiAgICAgICAgICBGUk9NIGRvY3VtZW50b3NfYWRqdW50b3MgZGFcclxuICAgICAgICAgIFdIRVJFIGRhLmlkX3BhY2llbnRlID0gcC5pZF9wYWNpZW50ZVxyXG4gICAgICAgICAgICBBTkQgZGEuZXN0YWRvID0gJ2FjdGl2bydcclxuICAgICAgICAgICAgQU5EIGRhLmVzX3B1YmxpY28gPSAwXHJcbiAgICAgICAgKSBhcyBkb2N1bWVudG9zX3BlbmRpZW50ZXMsXHJcblxyXG4gICAgICAgIC0tIGRpYWduw7NzdGljbyBwcmluY2lwYWxcclxuICAgICAgICAoXHJcbiAgICAgICAgICBTRUxFQ1QgZC5kaWFnbm9zdGljb1xyXG4gICAgICAgICAgRlJPTSBkaWFnbm9zdGljb3MgZFxyXG4gICAgICAgICAgV0hFUkUgZC5pZF9wYWNpZW50ZSA9IHAuaWRfcGFjaWVudGVcclxuICAgICAgICAgICAgQU5EIGQuaWRfbWVkaWNvID0gP1xyXG4gICAgICAgICAgICBBTkQgZC50aXBvID0gJ3ByaW5jaXBhbCdcclxuICAgICAgICAgICAgQU5EIGQuZXN0YWRvIElOICgnYWN0aXZvJywgJ2Nyb25pY28nLCAnZW5fdHJhdGFtaWVudG8nKVxyXG4gICAgICAgICAgT1JERVIgQlkgZC5mZWNoYV9kaWFnbm9zdGljbyBERVNDXHJcbiAgICAgICAgICBMSU1JVCAxXHJcbiAgICAgICAgKSBhcyBkaWFnbm9zdGljb19wcmluY2lwYWxcclxuXHJcbiAgICAgIEZST00gcGFjaWVudGVzIHBcclxuICAgICAgSU5ORVIgSk9JTiBwYWNpZW50ZXNfbWVkaWNvIHBtIE9OIHAuaWRfcGFjaWVudGUgPSBwbS5pZF9wYWNpZW50ZVxyXG4gICAgICBXSEVSRSBwLmlkX3BhY2llbnRlID0gP1xyXG4gICAgICAgIEFORCBwbS5pZF9tZWRpY28gPSA/XHJcbiAgICAgICAgQU5EIHBtLmFjdGl2byA9IDFcclxuICAgICAgTElNSVQgMVxyXG4gICAgICBgLFxyXG4gICAgICBbXHJcbiAgICAgICAgbWVkaWNvLmlkX21lZGljbywgLy8gdWx0aW1hIGNvbnN1bHRhXHJcbiAgICAgICAgbWVkaWNvLmlkX21lZGljbywgLy8gcHJveGltYSBjaXRhXHJcbiAgICAgICAgbWVkaWNvLmlkX21lZGljbywgLy8gdG90YWwgY29uc3VsdGFzXHJcbiAgICAgICAgbWVkaWNvLmlkX21lZGljbywgLy8gdG90YWwgY2l0YXNcclxuICAgICAgICBtZWRpY28uaWRfbWVkaWNvLCAvLyBtZWRpY2FtZW50b3MgYWN0aXZvc1xyXG4gICAgICAgIG1lZGljby5pZF9tZWRpY28sIC8vIGV4YW1lbmVzIHBlbmRcclxuICAgICAgICBtZWRpY28uaWRfbWVkaWNvLCAvLyBkaWFnIHByaW5jaXBhbFxyXG4gICAgICAgIGlkUGFjaWVudGUsXHJcbiAgICAgICAgbWVkaWNvLmlkX21lZGljbyxcclxuICAgICAgXVxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAocm93cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlBhY2llbnRlIG5vIGVuY29udHJhZG8gbyBubyBhc2lnbmFkbyBhbCBtw6lkaWNvXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDA0IH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwID0gcm93c1swXTtcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIHBhY2llbnRlOiB7XHJcbiAgICAgICAgICBpZF9wYWNpZW50ZTogcC5pZF9wYWNpZW50ZSxcclxuICAgICAgICAgIHJ1dDogcC5ydXQsXHJcbiAgICAgICAgICBub21icmU6IHAubm9tYnJlLFxyXG4gICAgICAgICAgYXBlbGxpZG9fcGF0ZXJubzogcC5hcGVsbGlkb19wYXRlcm5vLFxyXG4gICAgICAgICAgYXBlbGxpZG9fbWF0ZXJubzogcC5hcGVsbGlkb19tYXRlcm5vLFxyXG4gICAgICAgICAgbm9tYnJlX2NvbXBsZXRvOiBwLm5vbWJyZV9jb21wbGV0byxcclxuICAgICAgICAgIGZlY2hhX25hY2ltaWVudG86IHAuZmVjaGFfbmFjaW1pZW50byxcclxuICAgICAgICAgIGVkYWQ6IHAuZWRhZCxcclxuICAgICAgICAgIGdlbmVybzogcC5nZW5lcm8sXHJcbiAgICAgICAgICBlbWFpbDogcC5lbWFpbCxcclxuICAgICAgICAgIHRlbGVmb25vOiBwLnRlbGVmb25vLFxyXG4gICAgICAgICAgY2VsdWxhcjogcC5jZWx1bGFyLFxyXG4gICAgICAgICAgZGlyZWNjaW9uOiBwLmRpcmVjY2lvbixcclxuICAgICAgICAgIGNpdWRhZDogcC5jaXVkYWQsXHJcbiAgICAgICAgICByZWdpb246IHAucmVnaW9uLFxyXG4gICAgICAgICAgZm90b191cmw6IHAuZm90b191cmwsXHJcbiAgICAgICAgICBncnVwb19zYW5ndWluZW86IHAuZ3J1cG9fc2FuZ3VpbmVvIHx8IFwiZGVzY29ub2NpZG9cIixcclxuICAgICAgICAgIGVzdGFkbzogcC5lc3RhZG8sXHJcbiAgICAgICAgICBlc192aXA6IEJvb2xlYW4ocC5lc192aXApLFxyXG4gICAgICAgICAgZmVjaGFfcmVnaXN0cm86IHAuZmVjaGFfcmVnaXN0cm8sXHJcbiAgICAgICAgICBjbGFzaWZpY2FjaW9uX3JpZXNnbzogcC5jbGFzaWZpY2FjaW9uX3JpZXNnbyxcclxuICAgICAgICAgIHBlc29fa2c6IHAucGVzb19rZyxcclxuICAgICAgICAgIGFsdHVyYV9jbTogcC5hbHR1cmFfY20sXHJcbiAgICAgICAgICBpbWM6IHAuaW1jLFxyXG4gICAgICAgICAgbm90YXNfaW1wb3J0YW50ZXM6IHAubm90YXNfaW1wb3J0YW50ZXMsXHJcbiAgICAgICAgICB0YWdzOiBwLnRhZ3NcclxuICAgICAgICAgICAgPyB0eXBlb2YgcC50YWdzID09PSBcInN0cmluZ1wiXHJcbiAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKHAudGFncylcclxuICAgICAgICAgICAgICA6IHAudGFnc1xyXG4gICAgICAgICAgICA6IFtdLFxyXG4gICAgICAgICAgdWx0aW1hX2NvbnN1bHRhOiBwLnVsdGltYV9jb25zdWx0YSxcclxuICAgICAgICAgIHByb3hpbWFfY2l0YTogcC5wcm94aW1hX2NpdGEsXHJcbiAgICAgICAgICB0b3RhbF9jb25zdWx0YXM6IHAudG90YWxfY29uc3VsdGFzIHx8IDAsXHJcbiAgICAgICAgICB0b3RhbF9jaXRhczogcC50b3RhbF9jaXRhcyB8fCAwLFxyXG4gICAgICAgICAgYWxlcmdpYXNfY3JpdGljYXM6IHAuYWxlcmdpYXNfY3JpdGljYXMgfHwgMCxcclxuICAgICAgICAgIGNvbmRpY2lvbmVzX2Nyb25pY2FzOiBwLmNvbmRpY2lvbmVzX2Nyb25pY2FzIHx8IDAsXHJcbiAgICAgICAgICBtZWRpY2FtZW50b3NfYWN0aXZvczogcC5tZWRpY2FtZW50b3NfYWN0aXZvcyB8fCAwLFxyXG4gICAgICAgICAgZXhhbWVuZXNfcGVuZGllbnRlczogcC5leGFtZW5lc19wZW5kaWVudGVzIHx8IDAsXHJcbiAgICAgICAgICBkb2N1bWVudG9zX3BlbmRpZW50ZXM6IHAuZG9jdW1lbnRvc19wZW5kaWVudGVzIHx8IDAsXHJcbiAgICAgICAgICBkaWFnbm9zdGljb19wcmluY2lwYWw6IHAuZGlhZ25vc3RpY29fcHJpbmNpcGFsLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiAyMDAgfVxyXG4gICAgKTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGVuIEdFVCAvYXBpL21lZGljby9wYWNpZW50ZXMvW2lkXTpcIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6IFwiRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3JcIixcclxuICAgICAgICBkZXRhaWxzOlxyXG4gICAgICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwiZGV2ZWxvcG1lbnRcIiA/IGVycm9yLm1lc3NhZ2UgOiB1bmRlZmluZWQsXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFBVVCAvYXBpL21lZGljby9wYWNpZW50ZXMvW2lkXSAgLT4gYWN0dWFsaXphciAxIHBhY2llbnRlXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQVVQoXHJcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXHJcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgaWQ6IHN0cmluZyB9IH1cclxuKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGlkUGFjaWVudGUgPSBOdW1iZXIocGFyYW1zLmlkKTtcclxuICAgIGlmICghaWRQYWNpZW50ZSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSUQgZGUgcGFjaWVudGUgaW52w6FsaWRvXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZXNzaW9uVG9rZW4gPSBnZXRTZXNzaW9uVG9rZW4ocmVxdWVzdCk7XHJcbiAgICBpZiAoIXNlc3Npb25Ub2tlbikge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTm8gaGF5IHNlc2nDs24gYWN0aXZhXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAxIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2YWxpZGFyIHNlc2nDs25cclxuICAgIGNvbnN0IFtzZXNpb25lc10gPSBhd2FpdCBwb29sLnF1ZXJ5PFJvd0RhdGFQYWNrZXRbXT4oXHJcbiAgICAgIGBcclxuICAgICAgU0VMRUNUIHN1LmlkX3VzdWFyaW9cclxuICAgICAgRlJPTSBzZXNpb25lc191c3VhcmlvcyBzdVxyXG4gICAgICBJTk5FUiBKT0lOIHVzdWFyaW9zIHUgT04gc3UuaWRfdXN1YXJpbyA9IHUuaWRfdXN1YXJpb1xyXG4gICAgICBXSEVSRSBzdS50b2tlbiA9ID9cclxuICAgICAgICBBTkQgc3UuYWN0aXZhID0gMVxyXG4gICAgICAgIEFORCBzdS5mZWNoYV9leHBpcmFjaW9uID4gTk9XKClcclxuICAgICAgICBBTkQgdS5lc3RhZG8gPSAnYWN0aXZvJ1xyXG4gICAgICBMSU1JVCAxXHJcbiAgICAgIGAsXHJcbiAgICAgIFtzZXNzaW9uVG9rZW5dXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChzZXNpb25lcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlNlc2nDs24gaW52w6FsaWRhIG8gZXhwaXJhZGFcIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDEgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGlkVXN1YXJpbyA9IHNlc2lvbmVzWzBdLmlkX3VzdWFyaW87XHJcbiAgICBjb25zdCBtZWRpY28gPSBhd2FpdCBvYnRlbmVyTWVkaWNvQXV0ZW50aWNhZG8oaWRVc3VhcmlvKTtcclxuXHJcbiAgICBpZiAoIW1lZGljbykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTm8gdGllbmVzIHVuIHJlZ2lzdHJvIGRlIG3DqWRpY28gYWN0aXZvLlwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMyB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYXNlZ3VyYXJub3MgcXVlIGVsIHBhY2llbnRlIGVzdMOhIGFzaWduYWRvIGEgZXN0ZSBtw6lkaWNvXHJcbiAgICBjb25zdCBbYXNpZ25hY2lvbl0gPSBhd2FpdCBwb29sLnF1ZXJ5PFJvd0RhdGFQYWNrZXRbXT4oXHJcbiAgICAgIGBcclxuICAgICAgU0VMRUNUIDFcclxuICAgICAgRlJPTSBwYWNpZW50ZXNfbWVkaWNvXHJcbiAgICAgIFdIRVJFIGlkX3BhY2llbnRlID0gPyBBTkQgaWRfbWVkaWNvID0gPyBBTkQgYWN0aXZvID0gMVxyXG4gICAgICBMSU1JVCAxXHJcbiAgICAgIGAsXHJcbiAgICAgIFtpZFBhY2llbnRlLCBtZWRpY28uaWRfbWVkaWNvXVxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoYXNpZ25hY2lvbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6IFwiUGFjaWVudGUgbm8gYXNpZ25hZG8gYSBlc3RlIG3DqWRpY29cIixcclxuICAgICAgICB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcclxuXHJcbiAgICAvLyBsb3MgbWlzbW9zIGNhbXBvcyBxdWUgbWFuZGEgdHUgZnJvbnRlbmRcclxuICAgIGNvbnN0IHtcclxuICAgICAgcnV0LFxyXG4gICAgICBub21icmUsXHJcbiAgICAgIGFwZWxsaWRvX3BhdGVybm8sXHJcbiAgICAgIGFwZWxsaWRvX21hdGVybm8sXHJcbiAgICAgIGZlY2hhX25hY2ltaWVudG8sXHJcbiAgICAgIGdlbmVybyxcclxuICAgICAgZW1haWwsXHJcbiAgICAgIHRlbGVmb25vLFxyXG4gICAgICBjZWx1bGFyLFxyXG4gICAgICBkaXJlY2Npb24sXHJcbiAgICAgIGNpdWRhZCxcclxuICAgICAgcmVnaW9uLFxyXG4gICAgICBncnVwb19zYW5ndWluZW8sXHJcbiAgICAgIGVzX3ZpcCxcclxuICAgICAgY2xhc2lmaWNhY2lvbl9yaWVzZ28sXHJcbiAgICAgIHBlc29fa2csXHJcbiAgICAgIGFsdHVyYV9jbSxcclxuICAgICAgaW1jLFxyXG4gICAgICBlc3RhZG9fY2l2aWwsXHJcbiAgICAgIG9jdXBhY2lvbixcclxuICAgICAgbm90YXNfaW1wb3J0YW50ZXMsXHJcbiAgICAgIGlkX2NlbnRyb19yZWdpc3RybyxcclxuICAgIH0gPSBib2R5O1xyXG5cclxuICAgIC8vIGFybWFtb3MgVVBEQVRFIHNvbG8gY29uIGNvbHVtbmFzIHJlYWxlcyBkZSB0dSB0YWJsYSBgcGFjaWVudGVzYFxyXG4gICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBwb29sLnF1ZXJ5PFJlc3VsdFNldEhlYWRlcj4oXHJcbiAgICAgIGBcclxuICAgICAgVVBEQVRFIHBhY2llbnRlc1xyXG4gICAgICBTRVRcclxuICAgICAgICBydXQgPSA/LFxyXG4gICAgICAgIG5vbWJyZSA9ID8sXHJcbiAgICAgICAgYXBlbGxpZG9fcGF0ZXJubyA9ID8sXHJcbiAgICAgICAgYXBlbGxpZG9fbWF0ZXJubyA9ID8sXHJcbiAgICAgICAgZmVjaGFfbmFjaW1pZW50byA9ID8sXHJcbiAgICAgICAgZ2VuZXJvID0gPyxcclxuICAgICAgICBlbWFpbCA9ID8sXHJcbiAgICAgICAgdGVsZWZvbm8gPSA/LFxyXG4gICAgICAgIGNlbHVsYXIgPSA/LFxyXG4gICAgICAgIGRpcmVjY2lvbiA9ID8sXHJcbiAgICAgICAgY2l1ZGFkID0gPyxcclxuICAgICAgICByZWdpb24gPSA/LFxyXG4gICAgICAgIGdydXBvX3Nhbmd1aW5lbyA9ID8sXHJcbiAgICAgICAgZXNfdmlwID0gPyxcclxuICAgICAgICBjbGFzaWZpY2FjaW9uX3JpZXNnbyA9ID8sXHJcbiAgICAgICAgcGVzb19rZyA9ID8sXHJcbiAgICAgICAgYWx0dXJhX2NtID0gPyxcclxuICAgICAgICBpbWMgPSA/LFxyXG4gICAgICAgIGVzdGFkb19jaXZpbCA9ID8sXHJcbiAgICAgICAgb2N1cGFjaW9uID0gPyxcclxuICAgICAgICBub3Rhc19pbXBvcnRhbnRlcyA9ID8sXHJcbiAgICAgICAgaWRfY2VudHJvX3JlZ2lzdHJvID0gP1xyXG4gICAgICBXSEVSRSBpZF9wYWNpZW50ZSA9ID9cclxuICAgICAgTElNSVQgMVxyXG4gICAgICBgLFxyXG4gICAgICBbXHJcbiAgICAgICAgcnV0IHx8IG51bGwsXHJcbiAgICAgICAgbm9tYnJlLFxyXG4gICAgICAgIGFwZWxsaWRvX3BhdGVybm8sXHJcbiAgICAgICAgYXBlbGxpZG9fbWF0ZXJubyB8fCBudWxsLFxyXG4gICAgICAgIGZlY2hhX25hY2ltaWVudG8sXHJcbiAgICAgICAgZ2VuZXJvLFxyXG4gICAgICAgIGVtYWlsIHx8IG51bGwsXHJcbiAgICAgICAgdGVsZWZvbm8gfHwgbnVsbCxcclxuICAgICAgICBjZWx1bGFyIHx8IG51bGwsXHJcbiAgICAgICAgZGlyZWNjaW9uIHx8IG51bGwsXHJcbiAgICAgICAgY2l1ZGFkIHx8IG51bGwsXHJcbiAgICAgICAgcmVnaW9uIHx8IG51bGwsXHJcbiAgICAgICAgZ3J1cG9fc2FuZ3VpbmVvIHx8IFwiZGVzY29ub2NpZG9cIixcclxuICAgICAgICBlc192aXAgPyAxIDogMCxcclxuICAgICAgICBjbGFzaWZpY2FjaW9uX3JpZXNnbyB8fCBudWxsLFxyXG4gICAgICAgIC8vIG51bcOpcmljb3MgYSBudWxsIHNpIHZpZW5lbiB2YWPDrW9zXHJcbiAgICAgICAgcGVzb19rZyAhPT0gXCJcIiAmJiBwZXNvX2tnICE9PSB1bmRlZmluZWQgPyBwZXNvX2tnIDogbnVsbCxcclxuICAgICAgICBhbHR1cmFfY20gIT09IFwiXCIgJiYgYWx0dXJhX2NtICE9PSB1bmRlZmluZWQgPyBhbHR1cmFfY20gOiBudWxsLFxyXG4gICAgICAgIGltYyAhPT0gXCJcIiAmJiBpbWMgIT09IHVuZGVmaW5lZCA/IGltYyA6IG51bGwsXHJcbiAgICAgICAgZXN0YWRvX2NpdmlsIHx8IG51bGwsXHJcbiAgICAgICAgb2N1cGFjaW9uIHx8IG51bGwsXHJcbiAgICAgICAgbm90YXNfaW1wb3J0YW50ZXMgfHwgbnVsbCxcclxuICAgICAgICBpZF9jZW50cm9fcmVnaXN0cm8gfHwgbnVsbCxcclxuICAgICAgICBpZFBhY2llbnRlLFxyXG4gICAgICBdXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJObyBzZSBwdWRvIGFjdHVhbGl6YXIgZWwgcGFjaWVudGVcIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSwgeyBzdGF0dXM6IDIwMCB9KTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGVuIFBVVCAvYXBpL21lZGljby9wYWNpZW50ZXMvW2lkXTpcIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6IFwiRXJyb3IgYWwgZ3VhcmRhciBlbCBwYWNpZW50ZVwiLFxyXG4gICAgICAgIGRldGFpbHM6XHJcbiAgICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJkZXZlbG9wbWVudFwiID8gZXJyb3IubWVzc2FnZSA6IHVuZGVmaW5lZCxcclxuICAgICAgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuLy8gc2kgcXVpZXJlcyBibG9xdWVhciBERUxFVEUgcG9yIGFob3JhXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUoKSB7XHJcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTcOpdG9kbyBubyBwZXJtaXRpZG9cIiB9LFxyXG4gICAgeyBzdGF0dXM6IDQwNSB9XHJcbiAgKTtcclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicG9vbCIsIlNFU1NJT05fQ09PS0lFX0NBTkRJREFURVMiLCJnZXRTZXNzaW9uVG9rZW4iLCJyZXF1ZXN0IiwiY29va2llSGVhZGVyIiwiaGVhZGVycyIsImdldCIsImNvb2tpZXMiLCJzcGxpdCIsIm1hcCIsImMiLCJ0cmltIiwiZmlsdGVyIiwiQm9vbGVhbiIsInJlZHVjZSIsImFjYyIsImsiLCJyZXN0Iiwiam9pbiIsIm5hbWUiLCJkZWNvZGVVUklDb21wb25lbnQiLCJhdXRoIiwic3RhcnRzV2l0aCIsInNsaWNlIiwib2J0ZW5lck1lZGljb0F1dGVudGljYWRvIiwiaWRVc3VhcmlvIiwicm93cyIsInF1ZXJ5IiwibGVuZ3RoIiwiR0VUIiwicGFyYW1zIiwiaWRQYWNpZW50ZSIsIk51bWJlciIsImlkIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsInN0YXR1cyIsInNlc3Npb25Ub2tlbiIsInNlc2lvbmVzIiwiaWRfdXN1YXJpbyIsIm1lZGljbyIsImlkX21lZGljbyIsInAiLCJwYWNpZW50ZSIsImlkX3BhY2llbnRlIiwicnV0Iiwibm9tYnJlIiwiYXBlbGxpZG9fcGF0ZXJubyIsImFwZWxsaWRvX21hdGVybm8iLCJub21icmVfY29tcGxldG8iLCJmZWNoYV9uYWNpbWllbnRvIiwiZWRhZCIsImdlbmVybyIsImVtYWlsIiwidGVsZWZvbm8iLCJjZWx1bGFyIiwiZGlyZWNjaW9uIiwiY2l1ZGFkIiwicmVnaW9uIiwiZm90b191cmwiLCJncnVwb19zYW5ndWluZW8iLCJlc3RhZG8iLCJlc192aXAiLCJmZWNoYV9yZWdpc3RybyIsImNsYXNpZmljYWNpb25fcmllc2dvIiwicGVzb19rZyIsImFsdHVyYV9jbSIsImltYyIsIm5vdGFzX2ltcG9ydGFudGVzIiwidGFncyIsIkpTT04iLCJwYXJzZSIsInVsdGltYV9jb25zdWx0YSIsInByb3hpbWFfY2l0YSIsInRvdGFsX2NvbnN1bHRhcyIsInRvdGFsX2NpdGFzIiwiYWxlcmdpYXNfY3JpdGljYXMiLCJjb25kaWNpb25lc19jcm9uaWNhcyIsIm1lZGljYW1lbnRvc19hY3Rpdm9zIiwiZXhhbWVuZXNfcGVuZGllbnRlcyIsImRvY3VtZW50b3NfcGVuZGllbnRlcyIsImRpYWdub3N0aWNvX3ByaW5jaXBhbCIsImNvbnNvbGUiLCJkZXRhaWxzIiwicHJvY2VzcyIsIm1lc3NhZ2UiLCJ1bmRlZmluZWQiLCJQVVQiLCJhc2lnbmFjaW9uIiwiYm9keSIsImVzdGFkb19jaXZpbCIsIm9jdXBhY2lvbiIsImlkX2NlbnRyb19yZWdpc3RybyIsInJlc3VsdCIsImFmZmVjdGVkUm93cyIsIkRFTEVURSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/medico/pacientes/[id]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getConnection: () => (/* binding */ getConnection),\n/* harmony export */   getGlobalStats: () => (/* binding */ getGlobalStats),\n/* harmony export */   getUserByEmail: () => (/* binding */ getUserByEmail),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   verifyUserCredentials: () => (/* binding */ verifyUserCredentials),\n/* harmony export */   withTransaction: () => (/* binding */ withTransaction)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"(rsc)/./node_modules/mysql2/promise.js\");\n// ===============================================================\n// 📦 Archivo: src/lib/db.ts\n// 🧠 Descripción: Configuración central de conexión a MySQL y utilidades\n// ===============================================================\n\n// ===============================================================\n// 🔗 Conexión al pool MySQL (segura, reutilizable y escalable)\n// ===============================================================\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0__.createPool({\n    host: process.env.DB_HOST || \"localhost\",\n    user: process.env.DB_USER || \"root\",\n    password: process.env.DB_PASS || \"\",\n    database: process.env.DB_NAME || \"Anyssamed\",\n    waitForConnections: true,\n    connectionLimit: 10,\n    queueLimit: 0,\n    multipleStatements: false,\n    namedPlaceholders: true\n});\n// ===============================================================\n// 🧩 Función genérica para ejecutar consultas seguras\n// ===============================================================\nasync function query(sql, params = []) {\n    try {\n        const [rows] = await pool.query(sql, params);\n        return rows;\n    } catch (error) {\n        console.error(\"❌ Error en query MySQL:\", error.message);\n        throw new Error(`Error en consulta: ${error.message}`);\n    }\n}\n// ===============================================================\n// 👤 Obtener usuario por email o username (para login o validaciones)\n// ✅ Versión que PRIORIZA el rol MÉDICO y solo toma roles activos\n// ===============================================================\nasync function getUserByEmail(emailOrUsername) {\n    const sql = `\r\n    SELECT \r\n      u.id_usuario,\r\n      u.email,\r\n      u.username,\r\n      u.nombre,\r\n      u.apellido_paterno,\r\n      u.password_hash,\r\n      -- si no hay rol, devolvemos 'Sin Rol'\r\n      COALESCE(r.nombre, 'Sin Rol') AS rol\r\n    FROM usuarios u\r\n    -- solo roles activos del usuario\r\n    LEFT JOIN usuarios_roles ur \r\n      ON u.id_usuario = ur.id_usuario\r\n      AND ur.activo = 1\r\n    -- solo roles activos en la tabla roles\r\n    LEFT JOIN roles r \r\n      ON ur.id_rol = r.id_rol\r\n      AND r.estado = 'activo'\r\n    WHERE (u.email = ? OR u.username = ?)\r\n      AND u.estado = 'activo'\r\n    -- PRIORIDAD de rol:\r\n    -- 1) médico\r\n    -- 2) superadmin\r\n    -- 3) admin/administrativo\r\n    -- 4) secretaria\r\n    -- 5) técnico\r\n    -- 6) lo que quede\r\n    ORDER BY\r\n      CASE\r\n        WHEN LOWER(r.nombre) LIKE '%medico%' THEN 1\r\n        WHEN LOWER(r.nombre) LIKE '%super%' THEN 2\r\n        WHEN LOWER(r.nombre) LIKE '%admin%' THEN 3\r\n        WHEN LOWER(r.nombre) LIKE '%secret%' THEN 4\r\n        WHEN LOWER(r.nombre) LIKE '%tecnic%' THEN 5\r\n        ELSE 99\r\n      END,\r\n      r.nivel_jerarquia DESC\r\n    LIMIT 1\r\n  `;\n    const [rows] = await pool.query(sql, [\n        emailOrUsername,\n        emailOrUsername\n    ]);\n    return Array.isArray(rows) && rows.length > 0 ? rows[0] : null;\n}\n// ===============================================================\n// 🔒 Verificar credenciales del usuario\n// ===============================================================\nasync function verifyUserCredentials(emailOrUsername, passwordHash) {\n    const user = await getUserByEmail(emailOrUsername);\n    if (!user) return null;\n    if (user.password_hash !== passwordHash) return null;\n    return user;\n}\n// ===============================================================\n// 📊 Ejemplo de utilidad: obtener estadísticas globales\n// ===============================================================\nasync function getGlobalStats() {\n    const [[stats]] = await pool.query(`\r\n    SELECT \r\n      (SELECT COUNT(*) FROM usuarios) AS total_usuarios,\r\n      (SELECT COUNT(*) FROM pacientes) AS total_pacientes,\r\n      (SELECT COUNT(*) FROM medicos) AS total_medicos,\r\n      (SELECT COUNT(*) FROM centros_medicos) AS total_centros\r\n  `);\n    return stats;\n}\n// ===============================================================\n// 🔌 NUEVO: obtener una conexión dedicada (para transacciones)\n// ===============================================================\nasync function getConnection() {\n    const conn = await pool.getConnection();\n    try {\n        await conn.ping(); // valida la conexión\n    } catch (e) {\n        conn.release();\n        throw e;\n    }\n    return conn;\n}\n// ===============================================================\n// 🔁 NUEVO (opcional): helper para ejecutar en transacción\n// ===============================================================\nasync function withTransaction(fn) {\n    const conn = await getConnection();\n    try {\n        await conn.beginTransaction();\n        const result = await fn(conn);\n        await conn.commit();\n        return result;\n    } catch (err) {\n        try {\n            await conn.rollback();\n        } catch  {}\n        throw err;\n    } finally{\n        try {\n            conn.release();\n        } catch  {}\n    }\n}\n// ===============================================================\n// 🔁 Exportar conexión global\n// ===============================================================\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VSxRQUFRO1FBQUksRUFBRSxPQUFNLENBQUM7UUFDdEMsTUFBTUQ7SUFDUixTQUFVO1FBQ1IsSUFBSTtZQUFFVCxLQUFLRyxPQUFPO1FBQUksRUFBRSxPQUFNLENBQUM7SUFDakM7QUFDRjtBQUVBLGtFQUFrRTtBQUNsRSw4QkFBOEI7QUFDOUIsa0VBQWtFO0FBQ2xFLGlFQUFldkMsSUFBSUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL21lZGlzdWl0ZS1wcm8vLi9zcmMvbGliL2RiLnRzPzllNGYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIPCfk6YgQXJjaGl2bzogc3JjL2xpYi9kYi50c1xyXG4vLyDwn6egIERlc2NyaXBjacOzbjogQ29uZmlndXJhY2nDs24gY2VudHJhbCBkZSBjb25leGnDs24gYSBNeVNRTCB5IHV0aWxpZGFkZXNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5pbXBvcnQgbXlzcWwgZnJvbSBcIm15c3FsMi9wcm9taXNlXCI7XHJcbmltcG9ydCB0eXBlIHsgUG9vbENvbm5lY3Rpb24gfSBmcm9tIFwibXlzcWwyL3Byb21pc2VcIjsgLy8g4oaQIChzb2xvIHRpcG8pXHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g8J+UlyBDb25leGnDs24gYWwgcG9vbCBNeVNRTCAoc2VndXJhLCByZXV0aWxpemFibGUgeSBlc2NhbGFibGUpXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5jb25zdCBwb29sID0gbXlzcWwuY3JlYXRlUG9vbCh7XHJcbiAgaG9zdDogcHJvY2Vzcy5lbnYuREJfSE9TVCB8fCBcImxvY2FsaG9zdFwiLFxyXG4gIHVzZXI6IHByb2Nlc3MuZW52LkRCX1VTRVIgfHwgXCJyb290XCIsXHJcbiAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LkRCX1BBU1MgfHwgXCJcIixcclxuICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuREJfTkFNRSB8fCBcIkFueXNzYW1lZFwiLFxyXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcclxuICBjb25uZWN0aW9uTGltaXQ6IDEwLFxyXG4gIHF1ZXVlTGltaXQ6IDAsXHJcbiAgbXVsdGlwbGVTdGF0ZW1lbnRzOiBmYWxzZSxcclxuICBuYW1lZFBsYWNlaG9sZGVyczogdHJ1ZSxcclxufSk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g8J+nqSBGdW5jacOzbiBnZW7DqXJpY2EgcGFyYSBlamVjdXRhciBjb25zdWx0YXMgc2VndXJhc1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5KHNxbDogc3RyaW5nLCBwYXJhbXM6IGFueVtdID0gW10pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jvd3NdID0gYXdhaXQgcG9vbC5xdWVyeShzcWwsIHBhcmFtcyk7XHJcbiAgICByZXR1cm4gcm93cztcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGVuIHF1ZXJ5IE15U1FMOlwiLCBlcnJvci5tZXNzYWdlKTtcclxuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZW4gY29uc3VsdGE6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDwn5GkIE9idGVuZXIgdXN1YXJpbyBwb3IgZW1haWwgbyB1c2VybmFtZSAocGFyYSBsb2dpbiBvIHZhbGlkYWNpb25lcylcclxuLy8g4pyFIFZlcnNpw7NuIHF1ZSBQUklPUklaQSBlbCByb2wgTcOJRElDTyB5IHNvbG8gdG9tYSByb2xlcyBhY3Rpdm9zXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckJ5RW1haWwoZW1haWxPclVzZXJuYW1lOiBzdHJpbmcpIHtcclxuICBjb25zdCBzcWwgPSBgXHJcbiAgICBTRUxFQ1QgXHJcbiAgICAgIHUuaWRfdXN1YXJpbyxcclxuICAgICAgdS5lbWFpbCxcclxuICAgICAgdS51c2VybmFtZSxcclxuICAgICAgdS5ub21icmUsXHJcbiAgICAgIHUuYXBlbGxpZG9fcGF0ZXJubyxcclxuICAgICAgdS5wYXNzd29yZF9oYXNoLFxyXG4gICAgICAtLSBzaSBubyBoYXkgcm9sLCBkZXZvbHZlbW9zICdTaW4gUm9sJ1xyXG4gICAgICBDT0FMRVNDRShyLm5vbWJyZSwgJ1NpbiBSb2wnKSBBUyByb2xcclxuICAgIEZST00gdXN1YXJpb3MgdVxyXG4gICAgLS0gc29sbyByb2xlcyBhY3Rpdm9zIGRlbCB1c3VhcmlvXHJcbiAgICBMRUZUIEpPSU4gdXN1YXJpb3Nfcm9sZXMgdXIgXHJcbiAgICAgIE9OIHUuaWRfdXN1YXJpbyA9IHVyLmlkX3VzdWFyaW9cclxuICAgICAgQU5EIHVyLmFjdGl2byA9IDFcclxuICAgIC0tIHNvbG8gcm9sZXMgYWN0aXZvcyBlbiBsYSB0YWJsYSByb2xlc1xyXG4gICAgTEVGVCBKT0lOIHJvbGVzIHIgXHJcbiAgICAgIE9OIHVyLmlkX3JvbCA9IHIuaWRfcm9sXHJcbiAgICAgIEFORCByLmVzdGFkbyA9ICdhY3Rpdm8nXHJcbiAgICBXSEVSRSAodS5lbWFpbCA9ID8gT1IgdS51c2VybmFtZSA9ID8pXHJcbiAgICAgIEFORCB1LmVzdGFkbyA9ICdhY3Rpdm8nXHJcbiAgICAtLSBQUklPUklEQUQgZGUgcm9sOlxyXG4gICAgLS0gMSkgbcOpZGljb1xyXG4gICAgLS0gMikgc3VwZXJhZG1pblxyXG4gICAgLS0gMykgYWRtaW4vYWRtaW5pc3RyYXRpdm9cclxuICAgIC0tIDQpIHNlY3JldGFyaWFcclxuICAgIC0tIDUpIHTDqWNuaWNvXHJcbiAgICAtLSA2KSBsbyBxdWUgcXVlZGVcclxuICAgIE9SREVSIEJZXHJcbiAgICAgIENBU0VcclxuICAgICAgICBXSEVOIExPV0VSKHIubm9tYnJlKSBMSUtFICclbWVkaWNvJScgVEhFTiAxXHJcbiAgICAgICAgV0hFTiBMT1dFUihyLm5vbWJyZSkgTElLRSAnJXN1cGVyJScgVEhFTiAyXHJcbiAgICAgICAgV0hFTiBMT1dFUihyLm5vbWJyZSkgTElLRSAnJWFkbWluJScgVEhFTiAzXHJcbiAgICAgICAgV0hFTiBMT1dFUihyLm5vbWJyZSkgTElLRSAnJXNlY3JldCUnIFRIRU4gNFxyXG4gICAgICAgIFdIRU4gTE9XRVIoci5ub21icmUpIExJS0UgJyV0ZWNuaWMlJyBUSEVOIDVcclxuICAgICAgICBFTFNFIDk5XHJcbiAgICAgIEVORCxcclxuICAgICAgci5uaXZlbF9qZXJhcnF1aWEgREVTQ1xyXG4gICAgTElNSVQgMVxyXG4gIGA7XHJcbiAgY29uc3QgW3Jvd3NdOiBhbnkgPSBhd2FpdCBwb29sLnF1ZXJ5KHNxbCwgW2VtYWlsT3JVc2VybmFtZSwgZW1haWxPclVzZXJuYW1lXSk7XHJcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkocm93cykgJiYgcm93cy5sZW5ndGggPiAwID8gcm93c1swXSA6IG51bGw7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDwn5SSIFZlcmlmaWNhciBjcmVkZW5jaWFsZXMgZGVsIHVzdWFyaW9cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlVc2VyQ3JlZGVudGlhbHMoZW1haWxPclVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkSGFzaDogc3RyaW5nKSB7XHJcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldFVzZXJCeUVtYWlsKGVtYWlsT3JVc2VybmFtZSk7XHJcbiAgaWYgKCF1c2VyKSByZXR1cm4gbnVsbDtcclxuICBpZiAodXNlci5wYXNzd29yZF9oYXNoICE9PSBwYXNzd29yZEhhc2gpIHJldHVybiBudWxsO1xyXG4gIHJldHVybiB1c2VyO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g8J+TiiBFamVtcGxvIGRlIHV0aWxpZGFkOiBvYnRlbmVyIGVzdGFkw61zdGljYXMgZ2xvYmFsZXNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHbG9iYWxTdGF0cygpIHtcclxuICBjb25zdCBbW3N0YXRzXV06IGFueSA9IGF3YWl0IHBvb2wucXVlcnkoYFxyXG4gICAgU0VMRUNUIFxyXG4gICAgICAoU0VMRUNUIENPVU5UKCopIEZST00gdXN1YXJpb3MpIEFTIHRvdGFsX3VzdWFyaW9zLFxyXG4gICAgICAoU0VMRUNUIENPVU5UKCopIEZST00gcGFjaWVudGVzKSBBUyB0b3RhbF9wYWNpZW50ZXMsXHJcbiAgICAgIChTRUxFQ1QgQ09VTlQoKikgRlJPTSBtZWRpY29zKSBBUyB0b3RhbF9tZWRpY29zLFxyXG4gICAgICAoU0VMRUNUIENPVU5UKCopIEZST00gY2VudHJvc19tZWRpY29zKSBBUyB0b3RhbF9jZW50cm9zXHJcbiAgYCk7XHJcbiAgcmV0dXJuIHN0YXRzO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g8J+UjCBOVUVWTzogb2J0ZW5lciB1bmEgY29uZXhpw7NuIGRlZGljYWRhIChwYXJhIHRyYW5zYWNjaW9uZXMpXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29ubmVjdGlvbigpOiBQcm9taXNlPFBvb2xDb25uZWN0aW9uPiB7XHJcbiAgY29uc3QgY29ubiA9IGF3YWl0IHBvb2wuZ2V0Q29ubmVjdGlvbigpO1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBjb25uLnBpbmcoKTsgLy8gdmFsaWRhIGxhIGNvbmV4acOzblxyXG4gIH0gY2F0Y2ggKGUpIHtcclxuICAgIGNvbm4ucmVsZWFzZSgpO1xyXG4gICAgdGhyb3cgZTtcclxuICB9XHJcbiAgcmV0dXJuIGNvbm47XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDwn5SBIE5VRVZPIChvcGNpb25hbCk6IGhlbHBlciBwYXJhIGVqZWN1dGFyIGVuIHRyYW5zYWNjacOzblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdpdGhUcmFuc2FjdGlvbjxUPihcclxuICBmbjogKGNvbm46IFBvb2xDb25uZWN0aW9uKSA9PiBQcm9taXNlPFQ+XHJcbik6IFByb21pc2U8VD4ge1xyXG4gIGNvbnN0IGNvbm4gPSBhd2FpdCBnZXRDb25uZWN0aW9uKCk7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IGNvbm4uYmVnaW5UcmFuc2FjdGlvbigpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oY29ubik7XHJcbiAgICBhd2FpdCBjb25uLmNvbW1pdCgpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIHRyeSB7IGF3YWl0IGNvbm4ucm9sbGJhY2soKTsgfSBjYXRjaCB7fVxyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH0gZmluYWxseSB7XHJcbiAgICB0cnkgeyBjb25uLnJlbGVhc2UoKTsgfSBjYXRjaCB7fVxyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIPCflIEgRXhwb3J0YXIgY29uZXhpw7NuIGdsb2JhbFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuZXhwb3J0IGRlZmF1bHQgcG9vbDtcclxuXHJcbi8vIChvcGNpb25hbCkgcmUtZXhwb3J0IGRlbCB0aXBvIHBhcmEgdXNhcmxvIGVuIHJ1dGFzIHNpIHF1aWVyZXMgdGlwYXIgcGFyw6FtZXRyb3NcclxuZXhwb3J0IHR5cGUgeyBQb29sQ29ubmVjdGlvbiB9O1xyXG4iXSwibmFtZXMiOlsibXlzcWwiLCJwb29sIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiREJfSE9TVCIsInVzZXIiLCJEQl9VU0VSIiwicGFzc3dvcmQiLCJEQl9QQVNTIiwiZGF0YWJhc2UiLCJEQl9OQU1FIiwid2FpdEZvckNvbm5lY3Rpb25zIiwiY29ubmVjdGlvbkxpbWl0IiwicXVldWVMaW1pdCIsIm11bHRpcGxlU3RhdGVtZW50cyIsIm5hbWVkUGxhY2Vob2xkZXJzIiwicXVlcnkiLCJzcWwiLCJwYXJhbXMiLCJyb3dzIiwiZXJyb3IiLCJjb25zb2xlIiwibWVzc2FnZSIsIkVycm9yIiwiZ2V0VXNlckJ5RW1haWwiLCJlbWFpbE9yVXNlcm5hbWUiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJ2ZXJpZnlVc2VyQ3JlZGVudGlhbHMiLCJwYXNzd29yZEhhc2giLCJwYXNzd29yZF9oYXNoIiwiZ2V0R2xvYmFsU3RhdHMiLCJzdGF0cyIsImdldENvbm5lY3Rpb24iLCJjb25uIiwicGluZyIsImUiLCJyZWxlYXNlIiwid2l0aFRyYW5zYWN0aW9uIiwiZm4iLCJiZWdpblRyYW5zYWN0aW9uIiwicmVzdWx0IiwiY29tbWl0IiwiZXJyIiwicm9sbGJhY2siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/mysql2","vendor-chunks/iconv-lite","vendor-chunks/aws-ssl-profiles","vendor-chunks/long","vendor-chunks/named-placeholders","vendor-chunks/denque","vendor-chunks/is-property","vendor-chunks/lru.min","vendor-chunks/sqlstring","vendor-chunks/seq-queue","vendor-chunks/generate-function","vendor-chunks/safer-buffer"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute&page=%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmedico%2Fpacientes%2F%5Bid%5D%2Froute.ts&appDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CReactProjects%5Cmedisuite-pro%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();